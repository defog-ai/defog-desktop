(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[433],{84308:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/view-notebooks",function(){return o(86369)}])},31143:function(e,t,o){"use strict";var s=o(28598),c=o(1887),a=o.n(c);t.Z=()=>(0,s.jsxs)(a(),{children:[(0,s.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,s.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},62429:function(e,t,o){"use strict";var s=o(28598),c=o(82684),a=o(91568),i=o(79869),n=o(34376),r=o(89971),l=o(12691),d=o.n(l);t.Z=e=>{let{id:t,userType:o,children:l}=e,{Content:u,Sider:h}=i.Layout,[m,g]=(0,c.useState)([]),[x,p]=(0,c.useContext)(a._),j=(0,n.useRouter)(),redirect=e=>{"/"===e||e.endsWith(".html")||(e+=".html"),e="/static"+e,j.push(e)},logout=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),p({user:null,token:null,userType:null}),redirect("/log-in")};return(0,c.useEffect)(()=>{g("admin"==o?[{key:"manage-database",title:"Manage Database",icon:(0,s.jsxs)("a",{onClick:()=>redirect("/extract-metadata"),children:[(0,s.jsx)("p",{className:"mr-2",children:"\uD83D\uDCBE"}),"Manage DB"]})},{key:"manage-users",title:"Manage Users",icon:(0,s.jsxs)("a",{onClick:()=>redirect("/manage-users"),children:[(0,s.jsx)("p",{className:"mr-2",children:"\uD83D\uDD10"}),"Manage Users"]})},{key:"view-notebooks",title:"View your notebook",icon:(0,s.jsxs)("a",{onClick:()=>redirect("/view-notebooks"),children:[(0,s.jsx)("p",{className:"mr-2",children:"\uD83D\uDCD2"}),"Your Notebooks"]})},{key:"manage-tools",title:"Manage tools",icon:(0,s.jsxs)("a",{onClick:()=>redirect("/manage-tools"),children:[(0,s.jsx)("p",{className:"mr-2",children:(0,s.jsx)(r.pyo,{})}),"Manage tools"]})},{key:"check-readiness",title:"Check Readiness",icon:(0,s.jsx)("a",{onClick:()=>redirect("/check-readiness"),children:(0,s.jsx)("p",{className:"mr-2",children:"✅ Check Readiness"})})},{key:"align-model",title:"Align Model",icon:(0,s.jsx)("a",{onClick:()=>redirect("/align-model"),children:(0,s.jsx)("p",{className:"mr-2",children:"⚙️ Align Model"})})},{key:"query-data",title:"Query Data",icon:(0,s.jsx)("a",{onClick:()=>redirect("/query-data"),children:(0,s.jsx)("p",{className:"mr-2",children:"\uD83D\uDD0D Query Data"})})},{key:"logout",title:"Logout",icon:(0,s.jsxs)("a",{onClick:logout,children:[(0,s.jsx)("p",{className:"mr-2",children:"↪"})," Logout"]})}]:o?[{key:"view-notebooks",title:"View your notebook",icon:(0,s.jsx)("a",{onClick:()=>redirect("/view-notebooks"),children:"Your Notebooks"})},{key:"query-data",title:"Query Data",icon:(0,s.jsx)(d(),{href:"/query-data",children:"\uD83D\uDD0D Query Data"})},{key:"logout",title:"Logout",icon:(0,s.jsx)("a",{onClick:()=>redirect("/manage-tools"),children:"Logout"})}]:[])},[o]),(0,s.jsx)(i.Layout,{style:{height:"100vh"},children:(0,s.jsxs)(u,{children:[m.length?(0,s.jsx)(h,{style:{height:"100vh",position:"fixed"},children:(0,s.jsx)(i.v2,{style:{width:200,paddingTop:"2em",paddingBottom:"2em"},mode:"inline",selectedKeys:[t],items:m})}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)("div",{style:{paddingLeft:240,paddingTop:30,backgroundColor:"#f5f5f5"},children:l})]})})}},86369:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return view_notebooks}});var s=o(28598),c=o(82684),a=o(77652),i=o(12691),n=o.n(i);function DocIcon(e){var t;let{doc:o,addDocIcon:c=!1,recentlyViewed:i=!1,onClick:r=null}=e;return(0,s.jsxs)("div",{className:"doc-icon-ctr",children:[(0,s.jsxs)(n(),{target:"_blank",href:{pathname:"/doc",query:{docId:c?"new":o&&o.doc_id}},children:[(0,s.jsx)("div",{className:"doc-icon "+(c?"add-doc":""),children:c?(0,s.jsx)("p",{className:"add-doc-plus",children:"＋"}):(0,s.jsx)(s.Fragment,{})}),(0,s.jsx)("p",{className:"doc-title",children:c?"New doc":o.doc_title?o.doc_title:"Untitled"}),(0,s.jsxs)("p",{className:"doc-date",children:[i?"Last accessed: ":"",c?"":null==o?void 0:null===(t=o.timestamp)||void 0===t?void 0:t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}),i?(0,s.jsxs)("p",{className:"doc-date",children:["Created by: ",null==o?void 0:o.created_by]}):(0,s.jsx)(s.Fragment,{})]}),c||i?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)("div",{className:"doc-archive-icon",onClick:e=>{!r||"function"!=typeof r||c||i||(e.preventDefault(),r(o))},children:o.archived?(0,s.jsx)(a.IgE,{}):(0,s.jsx)(a.pu4,{})})]})}var r=o(91568),l=o(31143),d=o(54186),u=o(18953),h=o(62429),m=o(34376),g=o(79204),view_notebooks=()=>{let[e,t]=(0,c.useState)(!1),[o,a]=(0,c.useContext)(r._),[i,n]=(0,c.useState)([]),[x,p]=(0,c.useState)([]),[j,f]=(0,c.useState)([]),k=(0,m.useRouter)();async function archiveToggle(e){let t=e.doc_id,o=e.archived,s=j,c=i;o?(s=j.filter(e=>e.doc_id!==t),c=[...i,...j.filter(e=>e.doc_id===t).map(e=>(e.archived=!1,e))]):(s=[...j,...i.filter(e=>e.doc_id===t).map(e=>(e.archived=!0,e))],c=i.filter(e=>e.doc_id!==t)),f(s),n(c);let a=await fetch((0,g.Z)("http","toggle_archive_status"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc_id:t,archive_status:!o})});(a=await a.json()).success&&u.default.success("Successfully ".concat(o?"un":"","archived doc")),a.success||u.default.error("Error ".concat(o?"un":"","archiving doc"))}let getNotebooks=async()=>{if(!o.token)return;let e=await fetch((0,g.Z)("http","get_docs"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:o.token})});if((e=await e.json()).success){let t=e.docs,s=e.recently_viewed_docs||[];t.forEach(e=>{e.timestamp=new Date(e.timestamp)}),s=s.map(e=>({...e,timestamp:new Date(e.timestamp),created_by:e.username===o.user?"You":e.username})),t.sort((e,t)=>t.timestamp-e.timestamp),p(s),s.sort((e,t)=>t.timestamp-e.timestamp);let c=t.filter(e=>e.archived);t=t.filter(e=>!e.archived),f(c),n(t)}if(!e.success)throw Error(e.error_message);t(!1)};return(0,c.useEffect)(()=>{t(!0);let e=o.token,s=o.userType;if(!s){let t=localStorage.getItem("defogUser");if(e=localStorage.getItem("defogToken"),s=localStorage.getItem("defogUserType"),!t||!e||!s){k.push("/log-in");return}a({user:t,token:e,userType:s})}e?getNotebooks():k.push("/log-in")},[o,o.token]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Z,{}),(0,s.jsxs)(h.Z,{id:"view-notebooks",userType:o.userType,children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Notebooks"}),(0,s.jsx)("h2",{className:"text-lg mb-4",children:"Your notebooks"}),(0,s.jsx)("div",{className:"flex flex-wrap justify-start",children:i&&!e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(DocIcon,{addDocIcon:!0}),i.map(e=>(0,s.jsx)(DocIcon,{doc:e,onClick:archiveToggle},e.doc_id))]}):(0,s.jsx)("div",{children:"Loading docs..."})}),x.length?(0,s.jsx)("h2",{className:"text-lg mb-4",children:"Recently viewed"}):null,(0,s.jsx)("div",{className:"flex flex-wrap justify-start",children:x&&!e?(0,s.jsx)(s.Fragment,{children:x.map(e=>(0,s.jsx)(DocIcon,{doc:e,onClick:archiveToggle,recentlyViewed:!0},e.doc_id))}):(0,s.jsx)("div",{children:"Loading recently viewed docs..."})}),0===j.length?(0,s.jsx)(s.Fragment,{}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(d.default,{bordered:!1,size:"small",rootClassName:"archived-collapse",items:[{label:"Archived notebooks",key:"archived-docs",children:(0,s.jsx)("div",{className:"doc-icons-container",children:j.map(e=>(0,s.jsx)(DocIcon,{doc:e,onClick:archiveToggle},e.doc_id))})}]})})]})]})}},79204:function(e,t){"use strict";t.Z=(e,t)=>{if("http"!==e&&"ws"!==e)throw Error("Protocol not supported");return""!==t?"ws"===e?"".concat("http://localhost:33364".replace("http","ws"),"/").concat(t):"".concat("http://localhost:33364","/").concat(t):"".concat("http://localhost:33364")}}},function(e){e.O(0,[665,391,958,664,774,888,179],function(){return e(e.s=84308)}),_N_E=e.O()}]);