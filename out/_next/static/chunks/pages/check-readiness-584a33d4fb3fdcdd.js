(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[426],{65313:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/check-readiness",function(){return n(90244)}])},42449:function(e,t,n){"use strict";var s=n(28598),a=n(1887),i=n.n(a);let o=()=>(0,s.jsxs)(i(),{children:[(0,s.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,s.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]});t.Z=o},22500:function(e,t,n){"use strict";var s=n(28598),a=n(82684),i=n(36189),o=n(79869),l=n(34376);n(12691);var r=n(26978),d=n(47663),c=n(56572);let u=e=>{let{id:t,userType:n,children:u,rootClassNames:m="",contentClassNames:g=""}=e,{Content:h,Sider:y}=o.Ar,[f,x]=(0,a.useState)([]),[p,j]=(0,a.useContext)(i.S),k=(0,l.useRouter)(),v=e=>{k.push(e)},S=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),j({user:null,token:null,userType:null}),v("/log-in")},_=(0,d.usePathname)();(0,a.useEffect)(()=>{x(("admin"==n?[{key:"manage-database",title:"Manage Database",href:"/static/extract-metadata.html"},{key:"manage-users",title:"Manage Users",href:"/static/manage-users.html"},{key:"manage-tools",title:"Manage tools",href:"/static/manage-tools.html"},{key:"check-readiness",title:"Check Readiness",href:"/static/check-readiness.html"},{key:"align-model",title:"Align Model",href:"/static/align-model.html"},{key:"view-feedback",title:"View Feedback",href:"/static/view-feedback.html"},{key:"query-data",title:"Query Data",href:"/static/query-data.html"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:S}]:n?[{key:"query-data",title:"Query Data",href:"/static/query-data.html"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:S}]:[]).map(e=>(e.current=e.href==_,e)))},[n]);let[w,C]=(0,a.useState)("flex flex-col md:min-h-screen relative container mx-auto");return(0,a.useEffect)(()=>{"/query-data"===_&&C("flex flex-col md:min-h-screen relative")},[_]),(0,s.jsxs)("div",{className:(0,c.m6)(w,m),children:[f.length?(0,s.jsx)(r.l2,{rootClassNames:"border-b",items:f}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)("div",{className:(0,c.m6)("grow",g),children:u})]})};t.Z=u},90244:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var s=n(28598),a=n(82684),i=n(42449),o=n(16496),l=n(84672),r=n(30652),d=n(56193),c=n(71629),u=n(59081),m=n(8301),g=n(25761),h=n(21013),y=n(64268),f=n(50770),x=n(34376);let p=e=>{let{loading:t,metadataUploaded:n,glossaryUploaded:a,goldenQueriesUploaded:i}=e,o=(0,x.useRouter)();return(0,s.jsxs)(r.Z,{span:24,style:{paddingTop:"1em",paddingBottom:"1em"},children:[(0,s.jsxs)("h2",{children:[(0,s.jsx)(c.Z,{title:"Do regular quality checks to keep defog fully customised for databse",children:(0,s.jsx)(f.Z,{style:{marginRight:"0.5em",fontSize:"1.2em",color:"#1890ff",cursor:"pointer"}})}),"Basic Configuration Status"]}),(0,s.jsx)(h.Z,{style:{padding:"1.2em"},dataSource:[{key:"1",status:"Metadata Updated",tooltip:"Metadata (table names, columns names, column descriptions) updated on Defog",value:t?"⏳":n?"✅":"❌",onClick:()=>o.push("/extract-metadata")},{key:"2",status:"Instruction Set Updated",tooltip:"Explicit instructions to guide generation added to Defog",value:t?"⏳":a?"✅":"❌",onClick:()=>o.push("/align-model")},{key:"3",status:"Golden Queries Updated",tooltip:"Golden queries to ground the model's generation added to Defog",value:t?"⏳":i?"✅":"❌",onClick:()=>o.push("/align-model")}],columns:[{title:"Configuration",dataIndex:"status",key:"status",render:(e,t)=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{title:t.tooltip,children:(0,s.jsx)("span",{style:{cursor:"pointer"},children:e})}),(0,s.jsx)(y.Z,{style:{marginLeft:"0.5em",color:"#1890ff",cursor:"pointer"}})]}),align:"center",width:"50%"},{title:"Status",dataIndex:"value",key:"value",align:"center",width:"50%"}],pagination:!1,onRow:e=>({onClick:()=>e.onClick()})})]})};var j=n(4134),k=n(14081),v=n(59718),S=n(58012),_=n(15147),w=n(73584),C=n(2329);let Z=["#0088FE","#FF8042"],I=e=>{let{loadingGoldenQueries:t,totalGoldenQueries:n,totalGoldenQueriesValid:i,totalGoldenQueriesInvalid:o,invalidGoldenQueries:l,checkGoldenQueriesValidity:r}=e,[d,u]=(0,a.useState)(!1),g=[{name:"Valid Golden Queries",value:i},{name:"Invalid Golden Queries",value:o}],y=l.map((e,t)=>({key:t,question:"Question ".concat(t+1,": ").concat(e.question),sql:e.sql,error:e.valid_error})),f=()=>{d||r(),u(!d)};return(0,s.jsxs)("div",{style:{padding:"1.5em",paddingBottom:"0em"},children:[(0,s.jsxs)(j.ZP,{type:"primary",onClick:f,loading:t,ghost:!0,style:{width:"100%",marginTop:"1em"},children:[d?"Hide Golden Queries Validity":"1. Check Golden Queries Validity",(0,s.jsx)(c.Z,{title:"See if your golden queries can be executed against an empty database with your schema!",children:(0,s.jsx)(m.Z,{style:{marginLeft:"0em",fontSize:"1.2em",color:"#1890ff",cursor:"pointer"}})})]}),d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{style:{textAlign:"center",marginTop:"2em",marginBottom:"2em"},children:[(0,s.jsxs)("p",{style:{fontSize:"1.2em"},children:["Total Golden Queries: ",n]}),(0,s.jsxs)(v.u,{width:400,height:250,style:{margin:"0 auto"},children:[(0,s.jsx)(S.b,{data:g,cx:200,cy:100,outerRadius:100,fill:"#8884d8",dataKey:"value",children:g.map((e,t)=>(0,s.jsx)(_.b,{fill:Z[t%Z.length]},"cell-".concat(t)))}),(0,s.jsx)(w.u,{}),(0,s.jsx)(C.D,{})]})]}),(0,s.jsxs)("p",{style:{fontSize:"1.2em"},children:[(0,s.jsx)(k.Z,{style:{color:"#ff4d4f",marginRight:"0.5em"}}),"The following is a list of invalid Golden queries:"]}),(0,s.jsx)(h.Z,{dataSource:y,columns:[{title:"Question",dataIndex:"question",key:"question",width:"33%",align:"center"},{title:"SQL",dataIndex:"sql",key:"sql",width:"33%",align:"center"},{title:"Error",dataIndex:"error",key:"error",width:"33%",align:"center"}],pagination:!1,style:{marginTop:"1em"}})]})]})},T=e=>{let{loadingInstructionConsistency:t,instructionConsistencyRating:n,inconsistentInstructions:i,inconsistentReason:o,checkInstructionConsistency:l}=e,[r,d]=(0,a.useState)(!1),u=i.map((e,t)=>({key:t,instruction:e,reason:o[t]})),g=()=>{r||l(),d(!r)};return(0,s.jsxs)("div",{style:{padding:"1.5em",paddingBottom:"0em"},children:[(0,s.jsxs)(j.ZP,{type:"primary",onClick:g,loading:t,ghost:!0,style:{width:"100%"},children:[r?"Hide Instructions Consistency Check":"2. Check Instructions Consistency",(0,s.jsx)(c.Z,{title:"Make sure you instructions are consistent and do not contradict each other",children:(0,s.jsx)(m.Z,{style:{marginLeft:"0em",fontSize:"1.2em",color:"#1890ff",cursor:"pointer"}})})]}),r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"2rem",marginBottom:"1.5rem"},children:(0,s.jsx)("p",{style:{marginTop:"1.5em",color:-1===n.indexOf("Excellent")?"red":"green",fontWeight:"bold",margin:"auto",fontSize:"1.5rem"},children:n?-1===n.indexOf("Excellent")?"Your instructions have inconsistencies!":"Excellent: Your instructions are consistent!":""})}),n&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:(0,s.jsx)(h.Z,{dataSource:u,columns:[{title:"Inconsistent Instruction",dataIndex:"instruction",key:"instruction",width:"50%",align:"center"},{title:"Reason for Inconsistency",dataIndex:"reason",key:"reason",width:"50%",align:"center"}],pagination:!1})})})]})]})};var b=n(64611),q=n(14144),Q=n(65942);let G=e=>{let{loadingGoldenQueryCoverage:t,totalTables:n,totalColumns:i,coveredTables:o,coveredColumns:l,missingTables:r,checkGoldenQueryCoverage:d}=e,[u,g]=(0,a.useState)(!1),y=e=>Number(e).toPrecision(3),f=y(o/n*100),x=y(l/i*100),p=e=>e<10?"#ff4d4f":e<50?"#faad14":e<80?"#a0d911":"#52c41a",k=()=>{u||d(),g(!u)};return(0,s.jsxs)("div",{style:{padding:"1.5em",paddingBottom:"0em",marginBottom:"4rem"},children:[(0,s.jsxs)(j.ZP,{type:"primary",onClick:k,loading:t,ghost:!0,style:{width:"100%"},children:[u?"Hide Golden Query Coverage":"3. Check Golden Query Coverage",(0,s.jsx)(c.Z,{title:"See if your golden queries cover a significant portion of your schema and which tables are missing",children:(0,s.jsx)(m.Z,{style:{marginLeft:"0em",fontSize:"1.2em",color:"#1890ff",cursor:"pointer"}})})]}),u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{style:{marginTop:"4em"},children:(0,s.jsx)(h.Z,{dataSource:[{key:"1",category:"Tables",total:n,covered:o,percentage:f},{key:"2",category:"Columns",total:i,covered:l,percentage:x}],columns:[{title:"Category",dataIndex:"category",key:"category",width:"16.67%"},{title:"Total",dataIndex:"total",key:"total",width:"16.67%"},{title:"Mentioned ",dataIndex:"covered",key:"covered",width:"16.67%"},{title:"Coverage",dataIndex:"percentage",key:"percentage",width:"50%",render:e=>(0,s.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,s.jsx)(b.Z,{percent:e,status:"active",strokeColor:p(Number(e)),style:{flexGrow:1,marginRight:"10px"}})})}],pagination:!1,style:{marginBottom:"1em"}})}),(0,s.jsxs)("div",{style:{marginTop:"1em",marginBottom:"3em",width:"100%",maxHeight:"200px",overflowY:"auto"},children:[(0,s.jsxs)("p",{style:{marginTop:"1em",marginBottom:"1em",fontSize:"1.2em"},children:[(0,s.jsx)(Q.Z,{style:{color:"#ff4d4f",marginRight:"0.3em"}}),"The following tables are missing from the Golden queries:"]}),(0,s.jsx)(q.Z,{dataSource:r,renderItem:e=>(0,s.jsx)(q.Z.Item,{children:(0,s.jsx)(q.Z.Item.Meta,{title:(0,s.jsx)("div",{style:{textAlign:"center"},children:e})})}),bordered:!0})]})]})]})};var N=n(22500);let D=()=>{let[e,t]=(0,a.useState)(!1),[n,h]=(0,a.useState)(!1),[y,f]=(0,a.useState)(!1),[x,j]=(0,a.useState)(!1),[k,v]=(0,a.useState)(""),[S,_]=(0,a.useState)(!1),[w,C]=(0,a.useState)(!1),[Z,b]=(0,a.useState)(!1),[q,Q]=(0,a.useState)(0),[D,E]=(0,a.useState)(0),[R,B]=(0,a.useState)(0),[P,O]=(0,a.useState)([]),[z,F]=(0,a.useState)(""),[A,M]=(0,a.useState)([]),[U,L]=(0,a.useState)([]),[V,H]=(0,a.useState)(0),[J,Y]=(0,a.useState)(0),[X,K]=(0,a.useState)(0),[W,$]=(0,a.useState)(0),[ee,et]=(0,a.useState)([]),en="Demo".split(","),[es,ea]=(0,a.useState)(null),ei=async()=>{let e;if(localStorage.getItem("defogToken"))e=localStorage.getItem("defogToken");else{o.ZP.error("Please login to continue");return}t(!0);let n=await fetch("http://localhost:33364/readiness/basic",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,key_name:es})}),s=await n.json();s.success?(t(!1),_(s.metadata),C(s.golden_queries),b(s.glossary)):(t(!1),o.ZP.error("An error occurred while checking if your metadata was adequately added."))},eo=async()=>{h(!0);let e=await fetch("http://localhost:33364/readiness/check_golden_queries_validity",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:k,key_name:es})}),t=await e.json();h(!1),Q(t.total_golden_queries),B(t.invalid_golden_queries_count),E(t.total_golden_queries-t.invalid_golden_queries_count),O([...t.invalid_golden_queries]),console.log(t)},el=async()=>{f(!0);let e=await fetch("http://localhost:33364/readiness/check_instruction_consistency",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:k,key_name:es})}),t=await e.json();F(t.message),M([...t.inconsistent_glossary_lines]),L([...t.reasons_for_inconsistency]),f(!1),console.log(t)},er=async()=>{j(!0);let e=await fetch("http://localhost:33364/readiness/check_golden_query_coverage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:k,key_name:es})}),t=await e.json();H(t.num_total_tables),Y(t.num_total_cols),K(t.num_total_tables-t.num_missing_tables),$(t.num_total_cols-t.num_missing_cols),et([...t.missing_tables]),j(!1),console.log(t)};return(0,a.useEffect)(()=>{let e=localStorage.getItem("defogDbSelected");e?ea(e):ea(en[0])},[]),(0,a.useEffect)(()=>{let e=localStorage.getItem("defogToken");es&&(es&&localStorage.setItem("defogDbSelected",es),v(e),t(!0),setTimeout(()=>{ei()},100))},[es]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Z,{}),(0,s.jsxs)(N.Z,{id:"check-readiness",userType:"admin",children:[en.length>1?(0,s.jsx)(l.Z,{type:"flex",height:"100vh",children:(0,s.jsx)(r.Z,{span:24,style:{paddingBottom:"1em"},children:(0,s.jsx)(d.Z,{style:{width:"100%"},onChange:e=>{ea(e)},options:en.map(e=>({value:e,key:e,label:e})),value:es})})}):null,(0,s.jsx)("h1",{style:{display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"1em",paddingBottom:"0em"},children:(0,s.jsx)(u.Z,{style:{marginRight:"0.5em",fontSize:"3em",color:"#52c41a"}})}),(0,s.jsxs)("h1",{style:{display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"0.5em",paddingBottom:"1em"},children:["System Readiness Check",(0,s.jsx)(c.Z,{title:"Check if you have added aligned your Defog instance sufficiently",children:(0,s.jsx)(m.Z,{style:{marginLeft:"0.5em",fontSize:"1em",color:"#1890ff",cursor:"pointer"}})})]}),(0,s.jsxs)(l.Z,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,s.jsx)(p,{loading:e,metadataUploaded:S,glossaryUploaded:Z,goldenQueriesUploaded:w}),(0,s.jsxs)(r.Z,{span:24,style:{paddingTop:"1em"},children:[(0,s.jsxs)("h2",{style:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(c.Z,{title:"Do regular quality checks to keep defog fully customised for databse",children:(0,s.jsx)(g.Z,{style:{marginRight:"0.5em",fontSize:"1.2em",color:"#1890ff",cursor:"pointer"}})}),"Quality Checks"]}),(0,s.jsx)(I,{loadingGoldenQueries:n,totalGoldenQueries:q,totalGoldenQueriesValid:D,totalGoldenQueriesInvalid:R,invalidGoldenQueries:P,checkGoldenQueriesValidity:eo}),(0,s.jsx)(T,{loadingInstructionConsistency:y,instructionConsistencyRating:z,inconsistentInstructions:A,inconsistentReason:U,checkInstructionConsistency:el}),(0,s.jsx)(G,{loadingGoldenQueryCoverage:x,totalTables:V,totalColumns:J,coveredTables:X,coveredColumns:W,missingTables:ee,checkGoldenQueryCoverage:er})]})]})]})]})};var E=D}},function(e){e.O(0,[435,919,412,629,592,13,611,515,774,888,179],function(){return e(e.s=65313)}),_N_E=e.O()}]);