(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[224],{81659:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/align-model",function(){return s(16133)}])},31143:function(e,t,s){"use strict";var o=s(28598),n=s(1887),a=s.n(n);t.Z=()=>(0,o.jsxs)(a(),{children:[(0,o.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,o.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},62429:function(e,t,s){"use strict";var o=s(28598),n=s(82684),a=s(91568),i=s(79869),r=s(34376),l=s(89971),d=s(12691),c=s.n(d);t.Z=e=>{let{id:t,userType:s,children:d}=e,{Content:u,Sider:h}=i.Layout,[g,m]=(0,n.useState)([]),[p,y]=(0,n.useContext)(a._),x=(0,r.useRouter)(),redirect=e=>{"/"===e||e.endsWith(".html")||(e+=".html"),e="/static"+e,x.push(e)},logout=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),y({user:null,token:null,userType:null}),redirect("/log-in")};return(0,n.useEffect)(()=>{m("admin"==s?[{key:"manage-database",title:"Manage Database",icon:(0,o.jsxs)("a",{onClick:()=>redirect("/extract-metadata"),children:[(0,o.jsx)("p",{className:"mr-2",children:"\uD83D\uDCBE"}),"Manage DB"]})},{key:"manage-users",title:"Manage Users",icon:(0,o.jsxs)("a",{onClick:()=>redirect("/manage-users"),children:[(0,o.jsx)("p",{className:"mr-2",children:"\uD83D\uDD10"}),"Manage Users"]})},{key:"view-notebooks",title:"View your notebook",icon:(0,o.jsxs)("a",{onClick:()=>redirect("/view-notebooks"),children:[(0,o.jsx)("p",{className:"mr-2",children:"\uD83D\uDCD2"}),"Your Notebooks"]})},{key:"manage-tools",title:"Manage tools",icon:(0,o.jsxs)("a",{onClick:()=>redirect("/manage-tools"),children:[(0,o.jsx)("p",{className:"mr-2",children:(0,o.jsx)(l.pyo,{})}),"Manage tools"]})},{key:"check-readiness",title:"Check Readiness",icon:(0,o.jsx)("a",{onClick:()=>redirect("/check-readiness"),children:(0,o.jsx)("p",{className:"mr-2",children:"✅ Check Readiness"})})},{key:"align-model",title:"Align Model",icon:(0,o.jsx)("a",{onClick:()=>redirect("/align-model"),children:(0,o.jsx)("p",{className:"mr-2",children:"⚙️ Align Model"})})},{key:"query-data",title:"Query Data",icon:(0,o.jsx)("a",{onClick:()=>redirect("/query-data"),children:(0,o.jsx)("p",{className:"mr-2",children:"\uD83D\uDD0D Query Data"})})},{key:"logout",title:"Logout",icon:(0,o.jsxs)("a",{onClick:logout,children:[(0,o.jsx)("p",{className:"mr-2",children:"↪"})," Logout"]})}]:s?[{key:"view-notebooks",title:"View your notebook",icon:(0,o.jsx)("a",{onClick:()=>redirect("/view-notebooks"),children:"Your Notebooks"})},{key:"query-data",title:"Query Data",icon:(0,o.jsx)(c(),{href:"/query-data",children:"\uD83D\uDD0D Query Data"})},{key:"logout",title:"Logout",icon:(0,o.jsx)("a",{onClick:()=>redirect("/manage-tools"),children:"Logout"})}]:[])},[s]),(0,o.jsx)(i.Layout,{style:{height:"100vh"},children:(0,o.jsxs)(u,{children:[g.length?(0,o.jsx)(h,{style:{height:"100vh",position:"fixed"},children:(0,o.jsx)(i.v2,{style:{width:200,paddingTop:"2em",paddingBottom:"2em"},mode:"inline",selectedKeys:[t],items:g})}):(0,o.jsx)(o.Fragment,{}),(0,o.jsx)("div",{style:{paddingLeft:240,paddingTop:30,backgroundColor:"#f5f5f5"},children:d})]})})}},16133:function(e,t,s){"use strict";s.r(t);var o=s(28598),n=s(82684),a=s(31143),i=s(62429),r=s(79869),l=s(79204);t.default=()=>{let[e,t]=(0,n.useState)(!1),[s,d]=(0,n.useState)(""),[c,u]=(0,n.useState)([]),[h,g]=(0,n.useState)(""),[m,p]=(0,n.useState)(!1),[y,x]=(0,n.useState)(-1);(0,n.useEffect)(()=>{let t=localStorage.getItem("defogToken");g(t),getGlossaryGoldenQueries(e)},[e]);let getGlossaryGoldenQueries=async e=>{p(!0);let t=localStorage.getItem("defogToken");console.log("Right now, devMode is",e);try{let s=await fetch((0,l.Z)("http","integration/get_glossary_golden_queries"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,dev:e})}),o=await s.json();d(o.glossary),u(o.golden_queries),p(!1)}catch(e){console.error(e),p(!1),r.yw.error("Failed to get instructions. Are you sure you have updated your database credentials?")}},updateGlossary=async()=>{p(!0);let t=await fetch((0,l.Z)("http","integration/update_glossary"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({glossary:s,token:h,dev:e})});await t.json(),p(!1)},updateGoldenQueries=async()=>{p(!0);let t=await fetch((0,l.Z)("http","integration/update_golden_queries"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:h,golden_queries:c,dev:e})});await t.json(),p(!1)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Z,{}),(0,o.jsxs)(i.Z,{id:"align-model",userType:"admin",children:[(0,o.jsxs)("div",{style:{paddingBottom:"1em"},children:[(0,o.jsx)("h1",{children:"Align Model"}),(0,o.jsx)("p",{children:"Here, you can see the instructions and golden queries that the model is currently using to create SQL queries. You can change them here, and also get suggestions on how to improve them."})]}),(0,o.jsxs)(r.X2,{type:"flex",height:"100vh",gutter:16,children:[(0,o.jsx)(r.JX,{span:24,style:{paddingBottom:"1em"},children:(0,o.jsx)(r.rs,{checkedChildren:"Production",unCheckedChildren:"Development",checked:!e,onChange:e=>{t(!e),getGlossaryGoldenQueries(!e)}})}),(0,o.jsxs)(r.JX,{span:6,children:[(0,o.jsx)("h2",{children:"Instructions"}),(0,o.jsx)("p",{style:{paddingBottom:"1em"},children:"These instructions are used by the model as a guide for the SQL queries that it generates. You can change them below."}),(0,o.jsx)(r.II.TextArea,{value:s,onChange:e=>{d(e.target.value)},autoSize:{minRows:8},disabled:m}),(0,o.jsx)(r.zx,{type:"primary",style:{marginTop:"1em"},ghost:!0,onClick:updateGlossary,loading:m,disabled:m,children:"Update instructions on server"})]}),(0,o.jsxs)(r.JX,{span:18,children:[(0,o.jsx)("h2",{children:"Golden Queries"}),(0,o.jsxs)("p",{style:{paddingBottom:"1em"},children:["The golden queries are SQL queries used as examples by the model to learn about how your database is structured. You can see and edit them below.",(0,o.jsx)("br",{}),(0,o.jsx)("br",{})]}),(0,o.jsxs)(r.X2,{type:"flex",justify:"end",style:{paddingBottom:"1em"},gutter:16,children:[c.map((e,t)=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(r.JX,{span:8,style:{paddingBottom:"1em"},onMouseEnter:()=>{x(t)},onMouseLeave:()=>{x(-1)},children:[(0,o.jsx)(r.zx,{type:"primary",danger:!0,style:{position:"absolute",left:"0",bottom:"0",display:y==t?"block":"none"},onClick:()=>{let e=c.slice();e.splice(t,1),u(e)},disabled:m,loading:m,children:"Delete"}),(0,o.jsxs)("h3",{children:["Question ",t+1]}),(0,o.jsx)(r.II.TextArea,{value:e.question,onChange:e=>{let s=c.slice();s[t].question=e.target.value,u(s)},autoSize:{minRows:1},disabled:m})]}),(0,o.jsxs)(r.JX,{span:16,style:{paddingBottom:"1em"},children:[(0,o.jsxs)("h3",{children:["SQL Query ",t+1]}),(0,o.jsx)(r.II.TextArea,{value:e.sql,onChange:e=>{let s=c.slice();s[t].sql=e.target.value,u(s)},autoSize:{minRows:4,maxRows:8},disabled:m})]})]})),(0,o.jsx)(r.JX,{span:24,children:(0,o.jsx)(r.zx,{type:"primary",style:{marginTop:"1em"},ghost:!0,onClick:()=>{let e=c.slice();e.push({question:"",sql:""}),u(e)},loading:m,disabled:m,children:"Add new question and query"})}),(0,o.jsx)(r.JX,{span:24,children:(0,o.jsx)(r.zx,{type:"primary",style:{marginTop:"1em"},ghost:!0,onClick:updateGoldenQueries,loading:m,disabled:m,children:"Update golden queries on server"})})]})]})]})]})]})}},79204:function(e,t){"use strict";t.Z=(e,t)=>{if("http"!==e&&"ws"!==e)throw Error("Protocol not supported");return""!==t?"ws"===e?"".concat("http://localhost:33364".replace("http","ws"),"/").concat(t):"".concat("http://localhost:33364","/").concat(t):"".concat("http://localhost:33364")}}},function(e){e.O(0,[665,958,664,774,888,179],function(){return e(e.s=81659)}),_N_E=e.O()}]);