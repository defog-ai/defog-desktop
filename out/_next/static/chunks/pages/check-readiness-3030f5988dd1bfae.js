(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[426],{65313:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/check-readiness",function(){return s(95594)}])},26335:function(e,t,s){"use strict";var a=s(28598),n=s(1887),o=s.n(n);t.Z=()=>(0,a.jsxs)(o(),{children:[(0,a.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,a.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},82067:function(e,t,s){"use strict";var a=s(28598),n=s(82684),o=s(97574),i=s(79869),l=s(34376);s(12691);var r=s(26978),c=s(47663),d=s(56572);t.Z=e=>{let{id:t,userType:s,children:u,rootClassNames:m="",contentClassNames:g=""}=e,{Content:h,Sider:f}=i.Layout,[y,x]=(0,n.useState)([]),[p,k]=(0,n.useContext)(o.S),j=(0,l.useRouter)(),redirect=e=>{j.push(e)},logout=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),k({user:null,token:null,userType:null}),redirect("/static/log-in.html")},_=(0,c.usePathname)();(0,n.useEffect)(()=>{x(("admin"==s?[{key:"manage-database",title:"Manage Database",href:"/static/extract-metadata.html"},{key:"manage-users",title:"Manage Users",href:"/static/manage-users.html"},{key:"manage-tools",title:"Manage tools",href:"/static/manage-tools.html"},{key:"check-readiness",title:"Check Readiness",href:"/static/check-readiness.html"},{key:"align-model",title:"Align Model",href:"/static/align-model.html"},{key:"view-feedback",title:"View Feedback",href:"/static/view-feedback.html"},{key:"query-data",title:"Query Data",href:"/static/query-data.html"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:logout}]:s?[{key:"query-data",title:"Query Data",href:"/static/query-data.html"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:logout}]:[]).map(e=>(e.current=e.href==_,e)))},[s]);let[v,S]=(0,n.useState)("flex flex-col md:min-h-screen relative container mx-auto");return(0,n.useEffect)(()=>{"/query-data"===_&&S("flex flex-col md:min-h-screen relative")},[_]),(0,a.jsxs)("div",{className:(0,d.m6)(v,m),children:[y.length?(0,a.jsx)(r.l2,{rootClassNames:"border-b",items:y}):(0,a.jsx)(a.Fragment,{}),(0,a.jsx)("div",{className:(0,d.m6)("grow",g),children:u})]})}},95594:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return check_readiness}});var a=s(28598),n=s(82684),o=s(26335),i=s(37490),l=s(92696),r=s(24788),c=s(1065),d=s(18953),u=s(30964),m=s(2160),g=s(10998),h=s(45624),f=s(61706),y=s(34376),check_readiness_BasicStatus=e=>{let{loading:t,metadataUploaded:s,glossaryUploaded:n,goldenQueriesUploaded:o}=e,i=(0,y.useRouter)();return(0,a.jsxs)(l.default,{span:24,style:{paddingTop:"1em",paddingBottom:"1em"},children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold",children:[(0,a.jsx)(c.default,{title:"Do regular quality checks to keep defog fully customised for databse",children:(0,a.jsx)(h.Z,{style:{marginRight:"0.5em",color:"#1890ff",cursor:"pointer"}})}),"Basic Configuration Status"]}),(0,a.jsx)(g.default,{style:{padding:"1.2em"},dataSource:[{key:"1",status:"Metadata Updated",tooltip:"Metadata (table names, columns names, column descriptions) updated on Defog",value:t?"⏳":s?"✅":"❌",onClick:()=>i.push("/extract-metadata")},{key:"2",status:"Instruction Set Updated",tooltip:"Explicit instructions to guide generation added to Defog",value:t?"⏳":n?"✅":"❌",onClick:()=>i.push("/align-model")},{key:"3",status:"Golden Queries Updated",tooltip:"Golden queries to ground the model's generation added to Defog",value:t?"⏳":o?"✅":"❌",onClick:()=>i.push("/align-model")}],columns:[{title:"Configuration",dataIndex:"status",key:"status",render:(e,t)=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.default,{title:t.tooltip,children:(0,a.jsx)("span",{style:{cursor:"pointer"},children:e})}),(0,a.jsx)(f.Z,{style:{marginLeft:"0.5em",color:"#1890ff",cursor:"pointer"}})]}),align:"center",width:"50%"},{title:"Status",dataIndex:"value",key:"value",align:"center",width:"50%"}],pagination:!1,onRow:e=>({onClick:()=>e.onClick()})})]})},x=s(20259),p=s.n(x),k=s(17931),j=s(55658),_=s(59718),v=s(58012),S=s(15147),C=s(73584),w=s(2329);let I=["#0088FE","#FF8042"];var check_readiness_GoldenQueriesValidity=e=>{let{loadingGoldenQueries:t,totalGoldenQueries:s,totalGoldenQueriesValid:o,totalGoldenQueriesInvalid:i,invalidGoldenQueries:l,checkGoldenQueriesValidity:r}=e,[d,u]=(0,n.useState)(!1),m=[{name:"Valid Golden Queries",value:o},{name:"Invalid Golden Queries",value:i}],h=l.map((e,t)=>({key:t,question:"Question ".concat(t+1,": ").concat(e.question),sql:e.sql,error:e.valid_error}));return(0,a.jsxs)("div",{style:{padding:"1.5em",paddingBottom:"0em"},children:[(0,a.jsxs)(p(),{type:"primary",onClick:()=>{d||r(),u(!d)},loading:t,ghost:!0,style:{width:"100%",marginTop:"1em"},children:[d?"Hide Golden Queries Validity":"1. Check Golden Queries Validity",(0,a.jsx)(c.default,{title:"See if your golden queries can be executed against an empty database with your schema!",children:(0,a.jsx)(k.default,{style:{marginLeft:"0em",fontSize:"1.2em",color:"#1890ff",cursor:"pointer"}})})]}),d&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{textAlign:"center",marginTop:"2em",marginBottom:"2em"},children:[(0,a.jsxs)("p",{style:{fontSize:"1.2em"},children:["Total Golden Queries: ",s]}),(0,a.jsxs)(_.u,{width:400,height:250,style:{margin:"0 auto"},children:[(0,a.jsx)(v.b,{data:m,cx:200,cy:100,outerRadius:100,fill:"#8884d8",dataKey:"value",children:m.map((e,t)=>(0,a.jsx)(S.b,{fill:I[t%I.length]},"cell-".concat(t)))}),(0,a.jsx)(C.u,{}),(0,a.jsx)(w.D,{})]})]}),(0,a.jsxs)("p",{style:{fontSize:"1.2em"},children:[(0,a.jsx)(j.Z,{style:{color:"#ff4d4f",marginRight:"0.5em"}}),"The following is a list of invalid Golden queries:"]}),(0,a.jsx)(g.default,{dataSource:h,columns:[{title:"Question",dataIndex:"question",key:"question",width:"33%",align:"center"},{title:"SQL",dataIndex:"sql",key:"sql",width:"33%",align:"center"},{title:"Error",dataIndex:"error",key:"error",width:"33%",align:"center"}],pagination:!1,style:{marginTop:"1em"}})]})]})},check_readiness_InstructionConsistency=e=>{let{loadingInstructionConsistency:t,instructionConsistencyRating:s,inconsistentInstructions:o,inconsistentReason:i,checkInstructionConsistency:l}=e,[r,d]=(0,n.useState)(!1),u=o.map((e,t)=>({key:t,instruction:e,reason:i[t]}));return(0,a.jsxs)("div",{style:{padding:"1.5em",paddingBottom:"0em"},children:[(0,a.jsxs)(p(),{type:"primary",onClick:()=>{r||l(),d(!r)},loading:t,ghost:!0,style:{width:"100%"},children:[r?"Hide Instructions Consistency Check":"2. Check Instructions Consistency",(0,a.jsx)(c.default,{title:"Make sure you instructions are consistent and do not contradict each other",children:(0,a.jsx)(k.default,{style:{marginLeft:"0em",fontSize:"1.2em",color:"#1890ff",cursor:"pointer"}})})]}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"2rem",marginBottom:"1.5rem"},children:(0,a.jsx)("p",{style:{marginTop:"1.5em",color:-1===s.indexOf("Excellent")?"red":"green",fontWeight:"bold",margin:"auto",fontSize:"1.5rem"},children:s?-1===s.indexOf("Excellent")?"Your instructions have inconsistencies!":"Excellent: Your instructions are consistent!":""})}),s&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:(0,a.jsx)(g.default,{dataSource:u,columns:[{title:"Inconsistent Instruction",dataIndex:"instruction",key:"instruction",width:"50%",align:"center"},{title:"Reason for Inconsistency",dataIndex:"reason",key:"reason",width:"50%",align:"center"}],pagination:!1})})})]})]})},b=s(29807),T=s(37423),Q=s(55610),check_readiness_GoldenQueryCoverage=e=>{let{loadingGoldenQueryCoverage:t,totalTables:s,totalColumns:o,coveredTables:i,coveredColumns:l,missingTables:r,checkGoldenQueryCoverage:d}=e,[u,m]=(0,n.useState)(!1),formatPercentage=e=>Number(e).toPrecision(3),h=formatPercentage(i/s*100),f=formatPercentage(l/o*100),getProgressColor=e=>e<10?"#ff4d4f":e<50?"#faad14":e<80?"#a0d911":"#52c41a",y=[{key:"1",category:"Tables",total:s,covered:i,percentage:h},{key:"2",category:"Columns",total:o,covered:l,percentage:f}],x=[{title:"Category",dataIndex:"category",key:"category",width:"16.67%"},{title:"Total",dataIndex:"total",key:"total",width:"16.67%"},{title:"Mentioned ",dataIndex:"covered",key:"covered",width:"16.67%"},{title:"Coverage",dataIndex:"percentage",key:"percentage",width:"50%",render:e=>(0,a.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,a.jsx)(b.default,{percent:e,status:"active",strokeColor:getProgressColor(Number(e)),style:{flexGrow:1,marginRight:"10px"}})})}];return(0,a.jsxs)("div",{style:{padding:"1.5em",paddingBottom:"0em",marginBottom:"4rem"},children:[(0,a.jsxs)(p(),{type:"primary",onClick:()=>{u||d(),m(!u)},loading:t,ghost:!0,style:{width:"100%"},children:[u?"Hide Golden Query Coverage":"3. Check Golden Query Coverage",(0,a.jsx)(c.default,{title:"See if your golden queries cover a significant portion of your schema and which tables are missing",children:(0,a.jsx)(k.default,{style:{marginLeft:"0em",fontSize:"1.2em",color:"#1890ff",cursor:"pointer"}})})]}),u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{marginTop:"4em"},children:(0,a.jsx)(g.default,{dataSource:y,columns:x,pagination:!1,style:{marginBottom:"1em"}})}),(0,a.jsxs)("div",{style:{marginTop:"1em",marginBottom:"3em",width:"100%",maxHeight:"200px",overflowY:"auto"},children:[(0,a.jsxs)("p",{style:{marginTop:"1em",marginBottom:"1em",fontSize:"1.2em"},children:[(0,a.jsx)(Q.Z,{style:{color:"#ff4d4f",marginRight:"0.3em"}}),"The following tables are missing from the Golden queries:"]}),(0,a.jsx)(T.default,{dataSource:r,renderItem:e=>(0,a.jsx)(T.default.Item,{children:(0,a.jsx)(T.default.Item.Meta,{title:(0,a.jsx)("div",{style:{textAlign:"center"},children:e})})}),bordered:!0})]})]})]})},q=s(79204),G=s(82067),check_readiness=()=>{let[e,t]=(0,n.useState)(!1),[s,g]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),[y,x]=(0,n.useState)(!1),[p,k]=(0,n.useState)(""),[j,_]=(0,n.useState)(!1),[v,S]=(0,n.useState)(!1),[C,w]=(0,n.useState)(!1),[I,b]=(0,n.useState)(0),[T,Q]=(0,n.useState)(0),[N,B]=(0,n.useState)(0),[D,E]=(0,n.useState)([]),[R,P]=(0,n.useState)(""),[Z,O]=(0,n.useState)([]),[F,V]=(0,n.useState)([]),[z,M]=(0,n.useState)(0),[U,A]=(0,n.useState)(0),[L,H]=(0,n.useState)(0),[J,Y]=(0,n.useState)(0),[X,K]=(0,n.useState)([]),W="Defog".split(","),[$,ee]=(0,n.useState)(null),checkBasicReadiness=async()=>{let e;if(localStorage.getItem("defogToken"))e=localStorage.getItem("defogToken");else{d.default.error("Please login to continue");return}t(!0);let s=await fetch((0,q.Z)("http","readiness/basic"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,key_name:$})}),a=await s.json();a.success?(t(!1),_(a.metadata),S(a.golden_queries),w(a.glossary)):(t(!1),d.default.error("An error occurred while checking if your metadata was adequately added."),console.log(a))},checkGoldenQueriesValidity=async()=>{g(!0);let e=await fetch((0,q.Z)("http","readiness/check_golden_queries_validity"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:p,key_name:$})}),t=await e.json();g(!1),b(t.total_golden_queries),B(t.invalid_golden_queries_count),Q(t.total_golden_queries-t.invalid_golden_queries_count),E([...t.invalid_golden_queries]),console.log(t)},checkInstructionConsistency=async()=>{f(!0);let e=await fetch((0,q.Z)("http","readiness/check_instruction_consistency"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:p,key_name:$})}),t=await e.json();P(t.message),O([...t.inconsistent_glossary_lines]),V([...t.reasons_for_inconsistency]),f(!1),console.log(t)},checkGoldenQueryCoverage=async()=>{x(!0);let e=await fetch((0,q.Z)("http","readiness/check_golden_query_coverage"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:p,key_name:$})}),t=await e.json();M(t.num_total_tables),A(t.num_total_cols),H(t.num_total_tables-t.num_missing_tables),Y(t.num_total_cols-t.num_missing_cols),K([...t.missing_tables]),x(!1),console.log(t)};return(0,n.useEffect)(()=>{let e=localStorage.getItem("defogDbSelected");e?ee(e):ee(W[0])},[]),(0,n.useEffect)(()=>{let e=localStorage.getItem("defogToken");$&&($&&localStorage.setItem("defogDbSelected",$),k(e),t(!0),setTimeout(()=>{checkBasicReadiness()},100))},[$]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.Z,{}),(0,a.jsxs)(G.Z,{id:"check-readiness",userType:"admin",children:[W.length>1?(0,a.jsx)(i.default,{type:"flex",height:"100vh",children:(0,a.jsx)(l.default,{span:24,style:{paddingBottom:"1em"},children:(0,a.jsx)(r.default,{style:{width:"100%"},onChange:e=>{ee(e)},options:W.map(e=>({value:e,key:e,label:e})),value:$})})}):null,(0,a.jsxs)("div",{className:"flex justify-center items-center flex-col p-1 mt-1",children:[(0,a.jsxs)("h1",{children:[(0,a.jsx)(u.Z,{style:{fontSize:"3em",color:"#52c41a"}})," "]}),(0,a.jsx)("h1",{className:"text-2xl mt-4",children:"System Readiness Check"}),(0,a.jsx)("p",{className:"m-4",children:"Check if you have added aligned your Defog instance sufficiently. These checks help ensure that Defog can provide accurate results."})]}),(0,a.jsxs)(i.default,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,a.jsx)(check_readiness_BasicStatus,{loading:e,metadataUploaded:j,glossaryUploaded:C,goldenQueriesUploaded:v}),(0,a.jsxs)(l.default,{span:24,style:{paddingTop:"1em"},children:[(0,a.jsxs)("h2",{style:{display:"flex",alignItems:"center"},className:"text-lg font-semibold",children:[(0,a.jsx)(c.default,{title:"Do regular quality checks to keep defog fully customised for databse",children:(0,a.jsx)(m.Z,{style:{marginRight:"0.5em",fontSize:"1.2em",color:"#1890ff",cursor:"pointer"}})}),"Quality Checks"]}),(0,a.jsx)(check_readiness_GoldenQueriesValidity,{loadingGoldenQueries:s,totalGoldenQueries:I,totalGoldenQueriesValid:T,totalGoldenQueriesInvalid:N,invalidGoldenQueries:D,checkGoldenQueriesValidity:checkGoldenQueriesValidity}),(0,a.jsx)(check_readiness_InstructionConsistency,{loadingInstructionConsistency:h,instructionConsistencyRating:R,inconsistentInstructions:Z,inconsistentReason:F,checkInstructionConsistency:checkInstructionConsistency}),(0,a.jsx)(check_readiness_GoldenQueryCoverage,{loadingGoldenQueryCoverage:y,totalTables:z,totalColumns:U,coveredTables:L,coveredColumns:J,missingTables:X,checkGoldenQueryCoverage:checkGoldenQueryCoverage})]})]})]})]})}},79204:function(e,t){"use strict";t.Z=(e,t)=>{if("http"!==e&&"ws"!==e)throw Error("Protocol not supported");return(console.log("http://localhost:33364"),""!==t)?"ws"===e?"".concat("http://localhost:33364".replace("http","ws"),"/").concat(t):"".concat("http://localhost:33364","/").concat(t):"".concat("http://localhost:33364")}}},function(e){e.O(0,[435,25,774,888,179],function(){return e(e.s=65313)}),_N_E=e.O()}]);