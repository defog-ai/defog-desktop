"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[949],{60148:function(e,r,o){o.d(r,{EH:function(){return ji},Lb:function(){return Fi},Og:function(){return ai}});var a=Object.create,h=Object.defineProperty,c=Object.defineProperties,v=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertyNames,m=Object.getOwnPropertySymbols,b=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable,Pt=(e,r)=>{if(r=Symbol[e])return r;throw Error("Symbol."+e+" is not defined")},_n=(e,r,o)=>r in e?h(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,T=(e,r)=>{for(var o in r||(r={}))x.call(r,o)&&_n(e,o,r[o]);if(m)for(var o of m(r))w.call(r,o)&&_n(e,o,r[o]);return e},R=(e,r)=>c(e,g(r)),V=(e,r)=>{var o={};for(var a in e)x.call(e,a)&&0>r.indexOf(a)&&(o[a]=e[a]);if(null!=e&&m)for(var a of m(e))0>r.indexOf(a)&&w.call(e,a)&&(o[a]=e[a]);return o},H=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),_o=(e,r,o,a)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let c of y(r))x.call(e,c)||c===o||h(e,c,{get:()=>r[c],enumerable:!(a=v(r,c))||a.enumerable});return e},An=(e,r,o)=>(o=null!=e?a(b(e)):{},_o(!r&&e&&e.__esModule?o:h(o,"default",{value:e,enumerable:!0}),e)),At=(e,r,o)=>{if(!r.has(e))throw TypeError("Cannot "+o)},C=(e,r,o)=>(At(e,r,"read from private field"),o?o.call(e):r.get(e)),F=(e,r,o)=>{if(r.has(e))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(e):r.set(e,o)},P=(e,r,o,a)=>(At(e,r,"write to private field"),a?a.call(e,o):r.set(e,o),o),ae=(e,r,o)=>(At(e,r,"access private method"),o),Wo=function(e,r){this[0]=e,this[1]=r},Y=e=>{var r,o=e[Pt("asyncIterator")],a=!1,h={};return null==o?(o=e[Pt("iterator")](),r=e=>h[e]=r=>o[e](r)):(o=o.call(e),r=e=>h[e]=r=>{if(a){if(a=!1,"throw"===e)throw r;return r}return a=!0,{done:!1,value:new Wo(new Promise(a=>{var h=o[e](r);if(!(h instanceof Object))throw TypeError("Object expected");a(h)}),1)}}),h[Pt("iterator")]=()=>h,r("next"),"throw"in o?r("throw"):h.throw=e=>{throw e},"return"in o&&r("return"),h},I=H((e,r)=>{function ar(e,r,o,a){this.feasible=o,this.evaluation=r,this.bounded=a,this._tableau=e}r.exports=ar,ar.prototype.generateSolutionSet=function(){for(var e={},r=this._tableau,o=r.varIndexByRow,a=r.variablesPerIndex,h=r.matrix,c=r.rhsColumn,v=r.height-1,g=Math.round(1/r.precision),y=1;y<=v;y+=1){var m=a[o[y]];if(!(void 0===m||!0===m.isSlack)){var b=h[y][c];e[m.id]=Math.round((Number.EPSILON+b)*g)/g}}return e}}),M=H((e,r)=>{var o=I();function xt(e,r,a,h,c){o.call(this,e,r,a,h),this.iter=c}r.exports=xt,xt.prototype=Object.create(o.prototype),xt.constructor=xt}),k=H((e,r)=>{var o=I(),a=M();function ge(e){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=e||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}function un(e,r){this.priority=e,this.reducedCosts=Array(r);for(var o=0;o<r;o+=1)this.reducedCosts[o]=0}r.exports=ge,ge.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},un.prototype.copy=function(){var e=new un(this.priority,this.reducedCosts.length);return e.reducedCosts=this.reducedCosts.slice(),e},ge.prototype.setOptionalObjective=function(e,r,o){var a=this.objectivesByPriority[e];if(void 0===a){var h=Math.max(this.width,r+1);a=new un(e,h),this.objectivesByPriority[e]=a,this.optionalObjectives.push(a),this.optionalObjectives.sort(function(e,r){return e.priority-r.priority})}a.reducedCosts[r]=o},ge.prototype.initialize=function(e,r,o,a){this.variables=o,this.unrestrictedVars=a,this.width=e,this.height=r;for(var h=Array(e),c=0;c<e;c++)h[c]=0;this.matrix=Array(r);for(var v=0;v<r;v++)this.matrix[v]=h.slice();this.varIndexByRow=Array(this.height),this.varIndexByCol=Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=e+r-2,this.rowByVarIndex=Array(this.nVars),this.colByVarIndex=Array(this.nVars),this.lastElementIndex=this.nVars},ge.prototype._resetMatrix=function(){var e,r,o=this.model.variables,a=this.model.constraints,h=o.length,c=a.length,v=this.matrix[0],g=!0===this.model.isMinimization?-1:1;for(e=0;e<h;e+=1){var y=o[e],m=y.priority,b=g*y.cost;0===m?v[e+1]=b:this.setOptionalObjective(m,e+1,b),r=o[e].index,this.rowByVarIndex[r]=-1,this.colByVarIndex[r]=e+1,this.varIndexByCol[e+1]=r}for(var x=1,w=0;w<c;w+=1){var I=a[w],M=I.index;this.rowByVarIndex[M]=x,this.colByVarIndex[M]=-1,this.varIndexByRow[x]=M;var k,B,O=I.terms,S=O.length,_=this.matrix[x++];if(I.isUpperBound){for(k=0;k<S;k+=1)B=O[k],_[this.colByVarIndex[B.variable.index]]=B.coefficient;_[0]=I.rhs}else{for(k=0;k<S;k+=1)B=O[k],_[this.colByVarIndex[B.variable.index]]=-B.coefficient;_[0]=-I.rhs}}},ge.prototype.setModel=function(e){this.model=e;var r=e.nVariables+1,o=e.nConstraints+1;return this.initialize(r,o,e.variables,e.unrestrictedVariables),this._resetMatrix(),this},ge.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var e=this.lastElementIndex;return this.lastElementIndex+=1,e},ge.prototype.density=function(){for(var e=0,r=this.matrix,o=0;o<this.height;o++)for(var a=r[o],h=0;h<this.width;h++)0!==a[h]&&(e+=1);return e/(this.height*this.width)},ge.prototype.setEvaluation=function(){var e=Math.round(1/this.precision),r=Math.round((Number.EPSILON+this.matrix[this.costRowIndex][this.rhsColumn])*e)/e;this.evaluation=r,0===this.simplexIters&&(this.bestPossibleEval=r)},ge.prototype.getSolution=function(){var e=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new a(this,e,this.feasible,this.bounded,this.branchAndCutIterations):new o(this,e,this.feasible,this.bounded)}}),B=H(()=>{var e=k();e.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},e.prototype.phase1=function(){for(var e=this.model.checkForCycles,r=[],o=this.matrix,a=this.rhsColumn,h=this.width-1,c=this.height-1,v=0;;){for(var g=0,y=-this.precision,m=1;m<=c;m++){this.unrestrictedVars[this.varIndexByRow[m]];var b=o[m][a];b<y&&(y=b,g=m)}if(0===g)return this.feasible=!0,v;for(var x=0,w=-1/0,I=o[0],M=o[g],k=1;k<=h;k++){var B=M[k];if(!0===this.unrestrictedVars[this.varIndexByCol[k]]||B<-this.precision){var O=-I[k]/B;w<O&&(w=O,x=k)}}if(0===x)return this.feasible=!1,v;if(e){r.push([this.varIndexByRow[g],this.varIndexByCol[x]]);var S=this.checkForCycles(r);if(S.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+S[0]),this.model.messages.push("Length :"+S[1]),this.feasible=!1,v}this.pivot(g,x),v+=1}},e.prototype.phase2=function(){for(var e,r,o=this.model.checkForCycles,a=[],h=this.matrix,c=this.rhsColumn,v=this.width-1,g=this.height-1,y=this.precision,m=this.optionalObjectives.length,b=null,x=0;;){var w=h[this.costRowIndex];m>0&&(b=[]);for(var I=0,M=y,k=!1,B=1;B<=v;B++){if(e=w[B],r=!0===this.unrestrictedVars[this.varIndexByCol[B]],m>0&&-y<e&&e<y){b.push(B);continue}if(r&&e<0){-e>M&&(M=-e,I=B,k=!0);continue}e>M&&(M=e,I=B,k=!1)}if(m>0)for(var O=0;0===I&&b.length>0&&O<m;){var S=[],_=this.optionalObjectives[O].reducedCosts;M=y;for(var E=0;E<b.length;E++){if(e=_[B=b[E]],r=!0===this.unrestrictedVars[this.varIndexByCol[B]],-y<e&&e<y){S.push(B);continue}if(r&&e<0){-e>M&&(M=-e,I=B,k=!0);continue}e>M&&(M=e,I=B,k=!1)}b=S,O+=1}if(0===I)return this.setEvaluation(),this.simplexIters+=1,x;for(var j=0,z=1/0,N=(this.varIndexByRow,1);N<=g;N++){var $=h[N],L=$[c],W=$[I];if(!(-y<W&&W<y)){if(W>0&&y>L&&L>-y){z=0,j=N;break}var U=k?-L/W:L/W;U>y&&z>U&&(z=U,j=N)}}if(z===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[I],x;if(o){a.push([this.varIndexByRow[j],this.varIndexByCol[I]]);var G=this.checkForCycles(a);if(G.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+G[0]),this.model.messages.push("Length :"+G[1]),this.feasible=!1,x}this.pivot(j,I,!0),x+=1}};var r=[];e.prototype.pivot=function(e,o){var a=this.matrix,h=a[e][o],c=this.height-1,v=this.width-1,g=this.varIndexByRow[e],y=this.varIndexByCol[o];this.varIndexByRow[e]=y,this.varIndexByCol[o]=g,this.rowByVarIndex[y]=e,this.rowByVarIndex[g]=-1,this.colByVarIndex[y]=-1,this.colByVarIndex[g]=o;for(var m=a[e],b=0,x=0;x<=v;x++)m[x]>=-.0000000000000001&&m[x]<=1e-16?m[x]=0:(m[x]/=h,r[b]=x,b+=1);m[o]=1/h,this.precision;for(var w,I,M,k=0;k<=c;k++)if(k!==e&&!(a[k][o]>=-.0000000000000001&&a[k][o]<=1e-16)){var B=a[k];if((w=B[o])>=-.0000000000000001&&w<=1e-16)0!==w&&(B[o]=0);else{for(I=0;I<b;I++)(M=m[x=r[I]])>=-.0000000000000001&&M<=1e-16?0!==M&&(m[x]=0):B[x]=B[x]-w*M;B[o]=-w/h}}var O=this.optionalObjectives.length;if(O>0)for(var S=0;S<O;S+=1){var _=this.optionalObjectives[S].reducedCosts;if(0!==(w=_[o])){for(I=0;I<b;I++)0!==(M=m[x=r[I]])&&(_[x]=_[x]-w*M);_[o]=-w/h}}},e.prototype.checkForCycles=function(e){for(var r=0;r<e.length-1;r++)for(var o=r+1;o<e.length;o++){var a=e[r],h=e[o];if(a[0]===h[0]&&a[1]===h[1]){if(o-r>e.length-o)break;for(var c=!0,v=1;v<o-r;v++){var g=e[r+v],y=e[o+v];if(g[0]!==y[0]||g[1]!==y[1]){c=!1;break}}if(c)return[r,o-r]}}return[]}}),O=H((e,r)=>{function ln(e,r,o,a){this.id=e,this.cost=r,this.index=o,this.value=0,this.priority=a}function pr(e,r,o,a){ln.call(this,e,r,o,a)}function fn(e,r){ln.call(this,e,0,r,0)}function hr(e,r){this.variable=e,this.coefficient=r}function mr(e,r,o){return 0===o||"required"===o?null:(r=r||1,o=o||1,!1===e.isMinimization&&(r=-r),e.addVariable(r,"r"+e.relaxationIndex++,!1,!1,o))}function Te(e,r,o,a){this.slack=new fn("s"+o,o),this.index=o,this.model=a,this.rhs=e,this.isUpperBound=r,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function Ue(e,r){this.upperBound=e,this.lowerBound=r,this.model=e.model,this.rhs=e.rhs,this.relaxation=null}pr.prototype.isInteger=!0,fn.prototype.isSlack=!0,Te.prototype.addTerm=function(e,r){var o=r.index,a=this.termsByVarIndex[o];if(void 0===a)a=new hr(r,e),this.termsByVarIndex[o]=a,this.terms.push(a),!0===this.isUpperBound&&(e=-e),this.model.updateConstraintCoefficient(this,r,e);else{var h=a.coefficient+e;this.setVariableCoefficient(h,r)}return this},Te.prototype.removeTerm=function(e){return this},Te.prototype.setRightHandSide=function(e){if(e!==this.rhs){var r=e-this.rhs;!0===this.isUpperBound&&(r=-r),this.rhs=e,this.model.updateRightHandSide(this,r)}return this},Te.prototype.setVariableCoefficient=function(e,r){var o=r.index;if(-1===o){console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.");return}var a=this.termsByVarIndex[o];if(void 0===a)this.addTerm(e,r);else if(e!==a.coefficient){var h=e-a.coefficient;!0===this.isUpperBound&&(h=-h),a.coefficient=e,this.model.updateConstraintCoefficient(this,r,h)}return this},Te.prototype.relax=function(e,r){this.relaxation=mr(this.model,e,r),this._relax(this.relaxation)},Te.prototype._relax=function(e){null!==e&&(this.isUpperBound?this.setVariableCoefficient(-1,e):this.setVariableCoefficient(1,e))},Ue.prototype.isEquality=!0,Ue.prototype.addTerm=function(e,r){return this.upperBound.addTerm(e,r),this.lowerBound.addTerm(e,r),this},Ue.prototype.removeTerm=function(e){return this.upperBound.removeTerm(e),this.lowerBound.removeTerm(e),this},Ue.prototype.setRightHandSide=function(e){this.upperBound.setRightHandSide(e),this.lowerBound.setRightHandSide(e),this.rhs=e},Ue.prototype.relax=function(e,r){this.relaxation=mr(this.model,e,r),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)},r.exports={Constraint:Te,Variable:ln,IntegerVariable:pr,SlackVariable:fn,Equality:Ue,Term:hr}}),S=H(()=>{var e=k(),r=O().SlackVariable;e.prototype.addCutConstraints=function(e){for(var o=e.length,a=this.height,h=a+o,c=a;c<h;c+=1)void 0===this.matrix[c]&&(this.matrix[c]=this.matrix[c-1].slice());this.height=h,this.nVars=this.width+this.height-2;for(var v,g=this.width-1,y=0;y<o;y+=1){var m=e[y],b=a+y,x="min"===m.type?-1:1,w=m.varIndex,I=this.rowByVarIndex[w],M=this.matrix[b];if(-1===I){for(M[this.rhsColumn]=x*m.value,v=1;v<=g;v+=1)M[v]=0;M[this.colByVarIndex[w]]=x}else{var k=this.matrix[I],B=k[this.rhsColumn];for(M[this.rhsColumn]=x*(m.value-B),v=1;v<=g;v+=1)M[v]=-x*k[v]}var O=this.getNewElementIndex();this.varIndexByRow[b]=O,this.rowByVarIndex[O]=b,this.colByVarIndex[O]=-1,this.variablesPerIndex[O]=new r("s"+O,O),this.nVars+=1}},e.prototype._addLowerBoundMIRCut=function(e){if(e===this.costRowIndex)return!1;this.model;var o=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[e]].isInteger)return!1;var a=o[e][this.rhsColumn],h=a-Math.floor(a);if(h<this.precision||1-this.precision<h)return!1;var c=this.height;o[c]=o[c-1].slice(),this.height+=1,this.nVars+=1;var v=this.getNewElementIndex();this.varIndexByRow[c]=v,this.rowByVarIndex[v]=c,this.colByVarIndex[v]=-1,this.variablesPerIndex[v]=new r("s"+v,v),o[c][this.rhsColumn]=Math.floor(a);for(var g=1;g<this.varIndexByCol.length;g+=1)if(this.variablesPerIndex[this.varIndexByCol[g]].isInteger){var y=o[e][g],m=Math.floor(y)+Math.max(0,y-Math.floor(y)-h)/(1-h);o[c][g]=m}else o[c][g]=Math.min(0,o[e][g]/(1-h));for(var b=0;b<this.width;b+=1)o[c][b]-=o[e][b];return!0},e.prototype._addUpperBoundMIRCut=function(e){if(e===this.costRowIndex)return!1;this.model;var o=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[e]].isInteger)return!1;var a=o[e][this.rhsColumn],h=a-Math.floor(a);if(h<this.precision||1-this.precision<h)return!1;var c=this.height;o[c]=o[c-1].slice(),this.height+=1,this.nVars+=1;var v=this.getNewElementIndex();this.varIndexByRow[c]=v,this.rowByVarIndex[v]=c,this.colByVarIndex[v]=-1,this.variablesPerIndex[v]=new r("s"+v,v),o[c][this.rhsColumn]=-h;for(var g=1;g<this.varIndexByCol.length;g+=1){var y=this.variablesPerIndex[this.varIndexByCol[g]],m=o[e][g],b=m-Math.floor(m);y.isInteger?b<=h?o[c][g]=-b:o[c][g]=-(1-b)*h/b:m>=0?o[c][g]=-m:o[c][g]=m*h/(1-h)}return!0},e.prototype.applyMIRCuts=function(){}}),_=H(()=>{var e=k();e.prototype._putInBase=function(e){var r=this.rowByVarIndex[e];if(-1===r){for(var o=this.colByVarIndex[e],a=1;a<this.height;a+=1){var h=this.matrix[a][o];if(h<-this.precision||this.precision<h){r=a;break}}this.pivot(r,o)}return r},e.prototype._takeOutOfBase=function(e){var r=this.colByVarIndex[e];if(-1===r){for(var o=this.rowByVarIndex[e],a=this.matrix[o],h=1;h<this.height;h+=1){var c=a[h];if(c<-this.precision||this.precision<c){r=h;break}}this.pivot(o,r)}return r},e.prototype.updateVariableValues=function(){for(var e=this.variables.length,r=Math.round(1/this.precision),o=0;o<e;o+=1){var a=this.variables[o],h=a.index,c=this.rowByVarIndex[h];if(-1===c)a.value=0;else{var v=this.matrix[c][this.rhsColumn];a.value=Math.round((v+Number.EPSILON)*r)/r}}},e.prototype.updateRightHandSide=function(e,r){var o=this.height-1,a=this.rowByVarIndex[e.index];if(-1===a){for(var h=this.colByVarIndex[e.index],c=0;c<=o;c+=1){var v=this.matrix[c];v[this.rhsColumn]-=r*v[h]}var g=this.optionalObjectives.length;if(g>0)for(var y=0;y<g;y+=1){var m=this.optionalObjectives[y].reducedCosts;m[this.rhsColumn]-=r*m[h]}}else this.matrix[a][this.rhsColumn]-=r},e.prototype.updateConstraintCoefficient=function(e,r,o){if(e.index===r.index)throw Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var a=this._putInBase(e.index),h=this.colByVarIndex[r.index];if(-1===h)for(var c=this.rowByVarIndex[r.index],v=0;v<this.width;v+=1)this.matrix[a][v]+=o*this.matrix[c][v];else this.matrix[a][h]-=o},e.prototype.updateCost=function(e,r){var o=e.index,a=this.width-1,h=this.colByVarIndex[o];if(-1===h){var c,v=this.matrix[this.rowByVarIndex[o]];if(0===e.priority){var g=this.matrix[0];for(c=0;c<=a;c+=1)g[c]+=r*v[c]}else{var y=this.objectivesByPriority[e.priority].reducedCosts;for(c=0;c<=a;c+=1)y[c]+=r*v[c]}}else this.matrix[0][h]-=r},e.prototype.addConstraint=function(e){var r=e.isUpperBound?1:-1,o=this.height,a=this.matrix[o];void 0===a&&(a=this.matrix[0].slice(),this.matrix[o]=a);for(var h=this.width-1,c=0;c<=h;c+=1)a[c]=0;a[this.rhsColumn]=r*e.rhs;for(var v=e.terms,g=v.length,y=0;y<g;y+=1){var m=v[y],b=m.coefficient,x=m.variable.index,w=this.rowByVarIndex[x];if(-1===w)a[this.colByVarIndex[x]]+=r*b;else{var I=this.matrix[w];for(I[this.rhsColumn],c=0;c<=h;c+=1)a[c]-=r*b*I[c]}}var M=e.index;this.varIndexByRow[o]=M,this.rowByVarIndex[M]=o,this.colByVarIndex[M]=-1,this.height+=1},e.prototype.removeConstraint=function(e){var r=e.index,o=this.height-1,a=this._putInBase(r),h=this.matrix[o];this.matrix[o]=this.matrix[a],this.matrix[a]=h,this.varIndexByRow[a]=this.varIndexByRow[o],this.varIndexByRow[o]=-1,this.rowByVarIndex[r]=-1,this.availableIndexes[this.availableIndexes.length]=r,e.slack.index=-1,this.height-=1},e.prototype.addVariable=function(e){var r=this.height-1,o=this.width,a=!0===this.model.isMinimization?-e.cost:e.cost,h=e.priority,c=this.optionalObjectives.length;if(c>0)for(var v=0;v<c;v+=1)this.optionalObjectives[v].reducedCosts[o]=0;0===h?this.matrix[0][o]=a:(this.setOptionalObjective(h,o,a),this.matrix[0][o]=0);for(var g=1;g<=r;g+=1)this.matrix[g][o]=0;var y=e.index;this.varIndexByCol[o]=y,this.rowByVarIndex[y]=-1,this.colByVarIndex[y]=o,this.width+=1},e.prototype.removeVariable=function(e){var r=e.index,o=this._takeOutOfBase(r),a=this.width-1;if(o!==a){for(var h=this.height-1,c=0;c<=h;c+=1){var v=this.matrix[c];v[o]=v[a]}var g=this.optionalObjectives.length;if(g>0)for(var y=0;y<g;y+=1){var m=this.optionalObjectives[y].reducedCosts;m[o]=m[a]}var b=this.varIndexByCol[a];this.varIndexByCol[o]=b,this.colByVarIndex[b]=o}this.varIndexByCol[a]=-1,this.colByVarIndex[r]=-1,this.availableIndexes[this.availableIndexes.length]=r,e.index=-1,this.width-=1}}),E=H(()=>{k().prototype.log=function(e,r){console.log("****",e,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var o,a,h,c,v,g,y,m,b,x,w,I="",M=[" "];for(a=1;a<this.width;a+=1)v=this.varIndexByCol[a],y=(g=void 0===(c=this.variablesPerIndex[v])?"c"+v:c.id).length,m=" ",b="	",y>5?m+=" ":b+="	",M[a]=m,I+=b+g;console.log(I);var k=this.matrix[this.costRowIndex],B="	";for(o=1;o<this.width;o+=1)B+="	"+M[o]+k[o].toFixed(5);for(console.log((B+="	"+M[0]+k[0].toFixed(5))+"	Z"),h=1;h<this.height;h+=1){for(x=this.matrix[h],w="	",a=1;a<this.width;a+=1)w+="	"+M[a]+x[a].toFixed(5);w+="	"+M[0]+x[0].toFixed(5),v=this.varIndexByRow[h],console.log(w+"	"+(g=void 0===(c=this.variablesPerIndex[v])?"c"+v:c.id))}console.log("");var O=this.optionalObjectives.length;if(O>0){console.log("    Optional objectives:");for(var S=0;S<O;S+=1){var _=this.optionalObjectives[S].reducedCosts,E="";for(o=1;o<this.width;o+=1)E+=(_[o]<0?"":" ")+M[o]+_[o].toFixed(5);console.log((E+=(_[0]<0?"":" ")+M[0]+_[0].toFixed(5))+" z"+S)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this}}),j=H(()=>{var e=k();e.prototype.copy=function(){var r=new e(this.precision);r.width=this.width,r.height=this.height,r.nVars=this.nVars,r.model=this.model,r.variables=this.variables,r.variablesPerIndex=this.variablesPerIndex,r.unrestrictedVars=this.unrestrictedVars,r.lastElementIndex=this.lastElementIndex,r.varIndexByRow=this.varIndexByRow.slice(),r.varIndexByCol=this.varIndexByCol.slice(),r.rowByVarIndex=this.rowByVarIndex.slice(),r.colByVarIndex=this.colByVarIndex.slice(),r.availableIndexes=this.availableIndexes.slice();for(var o=[],a=0;a<this.optionalObjectives.length;a++)o[a]=this.optionalObjectives[a].copy();r.optionalObjectives=o;for(var h=this.matrix,c=Array(this.height),v=0;v<this.height;v++)c[v]=h[v].slice();return r.matrix=c,r},e.prototype.save=function(){this.savedState=this.copy()},e.prototype.restore=function(){if(null!==this.savedState){var e,r,o=this.savedState,a=o.matrix;for(this.nVars=o.nVars,this.model=o.model,this.variables=o.variables,this.variablesPerIndex=o.variablesPerIndex,this.unrestrictedVars=o.unrestrictedVars,this.lastElementIndex=o.lastElementIndex,this.width=o.width,this.height=o.height,e=0;e<this.height;e+=1){var h=a[e],c=this.matrix[e];for(r=0;r<this.width;r+=1)c[r]=h[r]}var v=o.varIndexByRow;for(r=0;r<this.height;r+=1)this.varIndexByRow[r]=v[r];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var g=o.varIndexByCol;for(e=0;e<this.width;e+=1)this.varIndexByCol[e]=g[e];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var y=o.rowByVarIndex,m=o.colByVarIndex,b=0;b<this.nVars;b+=1)this.rowByVarIndex[b]=y[b],this.colByVarIndex[b]=m[b];if(o.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var x=0;x<o.optionalObjectives.length;x++){var w=o.optionalObjectives[x].copy();this.optionalObjectives[x]=w,this.optionalObjectivePerPriority[w.priority]=w}}}}}),z=H(()=>{var e=k();function vr(e,r){this.index=e,this.value=r}e.prototype.getMostFractionalVar=function(){for(var e=0,r=null,o=null,a=this.model.integerVariables,h=a.length,c=0;c<h;c++){var v=a[c].index,g=this.rowByVarIndex[v];if(-1!==g){var y=this.matrix[g][this.rhsColumn],m=Math.abs(y-Math.round(y));e<m&&(e=m,r=v,o=y)}}return new vr(r,o)},e.prototype.getFractionalVarWithLowestCost=function(){for(var e=1/0,r=null,o=null,a=this.model.integerVariables,h=a.length,c=0;c<h;c++){var v=a[c],g=v.index,y=this.rowByVarIndex[g];if(-1!==y){var m=this.matrix[y][this.rhsColumn];if(Math.abs(m-Math.round(m))>this.precision){var b=v.cost;e>b&&(e=b,r=g,o=m)}}}return new vr(r,o)}}),N=H(()=>{var e=k();e.prototype.countIntegerValues=function(){for(var e=0,r=1;r<this.height;r+=1)if(this.variablesPerIndex[this.varIndexByRow[r]].isInteger){var o=this.matrix[r][this.rhsColumn];(o-=Math.floor(o))<this.precision&&-o<this.precision&&(e+=1)}return e},e.prototype.isIntegral=function(){for(var e=this.model.integerVariables,r=e.length,o=0;o<r;o++){var a=this.rowByVarIndex[e[o].index];if(-1!==a){var h=this.matrix[a][this.rhsColumn];if(Math.abs(h-Math.round(h))>this.precision)return!1}}return!0},e.prototype.computeFractionalVolume=function(e){for(var r=-1,o=1;o<this.height;o+=1)if(this.variablesPerIndex[this.varIndexByRow[o]].isInteger){var a=this.matrix[o][this.rhsColumn];if(Math.min((a=Math.abs(a))-Math.floor(a),Math.floor(a+1))<this.precision){if(!e)return 0}else -1===r?r=a:r*=a}return -1===r?0:r}}),$=H((e,r)=>{B(),S(),_(),E(),j(),z(),N(),r.exports=k()}),L=H(()=>{var e=k();function Or(e,r,o){this.type=e,this.varIndex=r,this.value=o}function hn(e,r){this.relaxedEvaluation=e,this.cuts=r}function hi(e,r){return r.relaxedEvaluation-e.relaxedEvaluation}e.prototype.applyCuts=function(e){if(this.restore(),this.addCutConstraints(e),this.simplex(),this.model.useMIRCuts)for(var r=!0;r;){var o=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),this.computeFractionalVolume(!0)>=.9*o&&(r=!1)}},e.prototype.branchAndCut=function(){var e=[],r=0,o=this.model.tolerance,a=!0,h=1e99;this.model.timeout&&(h=Date.now()+this.model.timeout);for(var c=1/0,v=null,g=[],y=0;y<this.optionalObjectives.length;y+=1)g.push(1/0);var m,b=new hn(-1/0,[]);for(e.push(b);e.length>0&&!0===a&&Date.now()<h;)if(m=this.model.isMinimization?this.bestPossibleEval*(1+o):this.bestPossibleEval*(1-o),o>0&&c<m&&(a=!1),!((b=e.pop()).relaxedEvaluation>c)){var x=b.cuts;if(this.applyCuts(x),r++,!1!==this.feasible){var w=this.evaluation;if(!(w>c)){if(w===c){for(var I=!0,M=0;M<this.optionalObjectives.length&&!(this.optionalObjectives[M].reducedCosts[0]>g[M]);M+=1)if(this.optionalObjectives[M].reducedCosts[0]<g[M]){I=!1;break}if(I)continue}if(!0===this.isIntegral()){if(this.__isIntegral=!0,1===r){this.branchAndCutIterations=r;return}v=b,c=w;for(var k=0;k<this.optionalObjectives.length;k+=1)g[k]=this.optionalObjectives[k].reducedCosts[0]}else{1===r&&this.save();for(var B=this.getMostFractionalVar(),O=B.index,S=[],_=[],E=x.length,j=0;j<E;j+=1){var z=x[j];z.varIndex===O?"min"===z.type?_.push(z):S.push(z):(S.push(z),_.push(z))}var N=Math.ceil(B.value),$=Math.floor(B.value),L=new Or("min",O,N);S.push(L);var W=new Or("max",O,$);_.push(W),e.push(new hn(w,S)),e.push(new hn(w,_)),e.sort(hi)}}}}null!==v&&this.applyCuts(v.cuts),this.branchAndCutIterations=r}}),W=H((e,r)=>{var o=k(),a=(L(),O()),h=a.Constraint,c=a.Equality,v=a.Variable,g=a.IntegerVariable;function J(e,r){this.tableau=new o(e),this.name=r,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}a.Term,r.exports=J,J.prototype.minimize=function(){return this.isMinimization=!0,this},J.prototype.maximize=function(){return this.isMinimization=!1,this},J.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var e=this.lastElementIndex;return this.lastElementIndex+=1,e},J.prototype._addConstraint=function(e){var r=e.slack;this.tableau.variablesPerIndex[r.index]=r,this.constraints.push(e),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(e)},J.prototype.smallerThan=function(e){var r=new h(e,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(r),r},J.prototype.greaterThan=function(e){var r=new h(e,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(r),r},J.prototype.equal=function(e){var r=new h(e,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(r);var o=new h(e,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(o),new c(r,o)},J.prototype.addVariable=function(e,r,o,a,h){if("string"==typeof h)switch(h){case"required":default:h=0;break;case"strong":h=1;break;case"medium":h=2;break;case"weak":h=3}var c,y=this.tableau.getNewElementIndex();return null==r&&(r="v"+y),null==e&&(e=0),null==h&&(h=0),o?(c=new g(r,e,y,h),this.integerVariables.push(c)):c=new v(r,e,y,h),this.variables.push(c),this.tableau.variablesPerIndex[y]=c,a&&(this.unrestrictedVariables[y]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(c),c},J.prototype._removeConstraint=function(e){var r=this.constraints.indexOf(e);if(-1===r){console.warn("[Model.removeConstraint] Constraint not present in model");return}this.constraints.splice(r,1),this.nConstraints-=1,!0===this.tableauInitialized&&this.tableau.removeConstraint(e),e.relaxation&&this.removeVariable(e.relaxation)},J.prototype.removeConstraint=function(e){return e.isEquality?(this._removeConstraint(e.upperBound),this._removeConstraint(e.lowerBound)):this._removeConstraint(e),this},J.prototype.removeVariable=function(e){var r=this.variables.indexOf(e);if(-1===r){console.warn("[Model.removeVariable] Variable not present in model");return}return this.variables.splice(r,1),!0===this.tableauInitialized&&this.tableau.removeVariable(e),this},J.prototype.updateRightHandSide=function(e,r){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(e,r),this},J.prototype.updateConstraintCoefficient=function(e,r,o){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(e,r,o),this},J.prototype.setCost=function(e,r){var o=e-r.cost;return!1===this.isMinimization&&(o=-o),r.cost=e,this.tableau.updateCost(r,o),this},J.prototype.loadJson=function(e){this.isMinimization="max"!==e.opType;for(var r=e.variables,o=e.constraints,a={},h={},v=Object.keys(o),g=v.length,y=0;y<g;y+=1){var m,b,x=v[y],w=o[x],I=w.equal,M=w.weight,k=w.priority,B=void 0!==M||void 0!==k;if(void 0===I){var O=w.min;void 0!==O&&(m=this.greaterThan(O),a[x]=m,B&&m.relax(M,k));var S=w.max;void 0!==S&&(b=this.smallerThan(S),h[x]=b,B&&b.relax(M,k))}else{m=this.greaterThan(I),a[x]=m,b=this.smallerThan(I),h[x]=b;var _=new c(m,b);B&&_.relax(M,k)}}var E=Object.keys(r),j=E.length;this.tolerance=e.tolerance||0,e.timeout&&(this.timeout=e.timeout),e.options&&(e.options.timeout&&(this.timeout=e.options.timeout),0===this.tolerance&&(this.tolerance=e.options.tolerance||0),e.options.useMIRCuts&&(this.useMIRCuts=e.options.useMIRCuts),void 0===e.options.exitOnCycles?this.checkForCycles=!0:this.checkForCycles=e.options.exitOnCycles);for(var z=e.ints||{},N=e.binaries||{},$=e.unrestricted||{},L=e.optimize,W=0;W<j;W+=1){var U=E[W],G=r[U],Z=G[L]||0,X=!!N[U],tt=!!z[U]||X,ti=!!$[U],to=this.addVariable(Z,U,tt,ti);X&&this.smallerThan(1).addTerm(1,to);var ts=Object.keys(G);for(y=0;y<ts.length;y+=1){var ta=ts[y];if(ta!==L){var tl=G[ta],th=a[ta];void 0!==th&&th.addTerm(tl,to);var tu=h[ta];void 0!==tu&&tu.addTerm(tl,to)}}}return this},J.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},J.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},J.prototype.isFeasible=function(){return this.tableau.feasible},J.prototype.save=function(){return this.tableau.save()},J.prototype.restore=function(){return this.tableau.restore()},J.prototype.activateMIRCuts=function(e){this.useMIRCuts=e},J.prototype.debug=function(e){this.checkForCycles=e},J.prototype.log=function(e){return this.tableau.log(e)}}),U=H(e=>{e.CleanObjectiveAttributes=function(e){var r,o,a;if("string"==typeof e.optimize){if(!e.constraints[e.optimize])return e;for(o in r=Math.random(),e.variables)e.variables[o][e.optimize]&&(e.variables[o][r]=e.variables[o][e.optimize]);return e.constraints[r]=e.constraints[e.optimize],delete e.constraints[e.optimize],e}for(a in e.optimize)if(e.constraints[a]){if("equal"===e.constraints[a])delete e.optimize[a];else{for(o in r=Math.random(),e.variables)e.variables[o][a]&&(e.variables[o][r]=e.variables[o][a]);e.constraints[r]=e.constraints[a],delete e.constraints[a]}}return e}}),G=H((e,r)=>{r.exports=function(e){return e.length?function(e){var r={is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},o={opType:"",optimize:"_obj",constraints:{},variables:{}},a={">=":"min","<=":"max","=":"equal"},h="",c=null,v="",g="",y="",m=0;"string"==typeof e&&(e=e.split(`
`));for(var b=0;b<e.length;b++)if(y="__"+b,h=e[b],c=null,r.is_objective.test(h))o.opType=h.match(/(max|min)/gi)[0],(c=h.match(r.parse_lhs).map(function(e){return e.replace(/\s+/,"")}).slice(1)).forEach(function(e){v=parseFloat(v=null===(v=e.match(r.get_num))?"-"===e.substr(0,1)?-1:1:v[0]),g=e.match(r.get_word)[0].replace(/\;$/,""),o.variables[g]=o.variables[g]||{},o.variables[g]._obj=v});else if(r.is_int.test(h))c=h.match(r.parse_int).slice(1),o.ints=o.ints||{},c.forEach(function(e){e=e.replace(";",""),o.ints[e]=1});else if(r.is_bin.test(h))c=h.match(r.parse_bin).slice(1),o.binaries=o.binaries||{},c.forEach(function(e){e=e.replace(";",""),o.binaries[e]=1});else if(r.is_constraint.test(h)){var x=h.indexOf(":");(c=(-1===x?h:h.slice(x+1)).match(r.parse_lhs).map(function(e){return e.replace(/\s+/,"")})).forEach(function(e){v=parseFloat(v=null===(v=e.match(r.get_num))?"-"===e.substr(0,1)?-1:1:v[0]),g=e.match(r.get_word)[0],o.variables[g]=o.variables[g]||{},o.variables[g][y]=v}),m=parseFloat(h.match(r.parse_rhs)[0]),h=a[h.match(r.parse_dir)[0]],o.constraints[y]=o.constraints[y]||{},o.constraints[y][h]=m}else r.is_unrestricted.test(h)&&(c=h.match(r.parse_int).slice(1),o.unrestricted=o.unrestricted||{},c.forEach(function(e){e=e.replace(";",""),o.unrestricted[e]=1}));return o}(e):function(e){if(!e)throw Error("Solver requires a model to operate on");var r="",o={max:"<=",min:">=",equal:"="},a=RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(e.opType)for(var h in r+=e.opType+":",e.variables)e.variables[h][h]=e.variables[h][h]?e.variables[h][h]:1,e.variables[h][e.optimize]&&(r+=" "+e.variables[h][e.optimize]+" "+h.replace(a,"_"));else r+="max:";for(var c in r+=`;

`,e.constraints)for(var v in e.constraints[c])if(void 0!==o[v]){for(var g in e.variables)void 0!==e.variables[g][c]&&(r+=" "+e.variables[g][c]+" "+g.replace(a,"_"));r+=" "+o[v]+" "+e.constraints[c][v]+`;
`}if(e.ints)for(var y in r+=`

`,e.ints)r+="int "+y.replace(a,"_")+`;
`;if(e.unrestricted)for(var m in r+=`

`,e.unrestricted)r+="unrestricted "+m.replace(a,"_")+`;
`;return r}(e)}}),Z=H(()=>{}),X=H(()=>{}),tt=H(e=>{function $r(e){return e=(e=(e=e.replace("\\r\\n",`\r
`)).split(`\r
`)).filter(function(e){return!(!0===RegExp(" 0$","gi").test(e)||!1===RegExp("\\d$","gi").test(e))}).map(function(e){return e.split(/\:{0,1} +(?=\d)/)}).reduce(function(e,r,o){return e[r[0]]=r[1],e},{})}e.reformat=G(),e.solve=function(e){return new Promise(function(r,o){"undefined"!=typeof window&&o("Function Not Available in Browser");var a=G()(e);e.external||o("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),e.external.binPath||o("No Executable | Binary path provided in arguments as 'binPath'"),e.external.args||o("No arguments array for cli | bash provided on 'args' attribute"),e.external.tempName||o("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on"),Z().writeFile(e.external.tempName,a,function(a,h){if(a)o(a);else{var c=X().execFile;e.external.args.push(e.external.tempName),c(e.external.binPath,e.external.args,function(e,a){e?1===e.code?r($r(a)):o({code:e.code,meaning:{"-2":"Out of Memory",1:"SUBOPTIMAL",2:"INFEASIBLE",3:"UNBOUNDED",4:"DEGENERATE",5:"NUMFAILURE",6:"USER-ABORT",7:"TIMEOUT",9:"PRESOLVED",25:"ACCURACY ERROR",255:"FILE-ERROR"}[e.code],data:a}):r($r(a))})}})})}}),ti=H((e,r)=>{r.exports={lpsolve:tt()}}),to=H((e,r)=>{r.exports=function(e,r){var o,a,h,c,v,g=r.optimize,y=JSON.parse(JSON.stringify(r.optimize)),m=Object.keys(r.optimize),b=0,x={},w="",I={},M=[];for(delete r.optimize,a=0;a<m.length;a++)y[m[a]]=0;for(a=0;a<m.length;a++){for(v in r.optimize=m[a],r.opType=g[m[a]],o=e.Solve(r,void 0,void 0,!0),m)if(!r.variables[m[v]])for(c in o[m[v]]=o[m[v]]?o[m[v]]:0,r.variables)r.variables[c][m[v]]&&o[c]&&(o[m[v]]+=o[c]*r.variables[c][m[v]]);for(w="base",h=0;h<m.length;h++)o[m[h]]?w+="-"+(1e3*o[m[h]]|0)/1e3:w+="-0";if(!x[w]){for(x[w]=1,b++,h=0;h<m.length;h++)o[m[h]]&&(y[m[h]]+=o[m[h]]);delete o.feasible,delete o.result,M.push(o)}}for(a=0;a<m.length;a++)r.constraints[m[a]]={equal:y[m[a]]/b};for(a in r.optimize="cheater-"+Math.random(),r.opType="max",r.variables)r.variables[a].cheater=1;for(a in M)for(c in M[a])I[c]=I[c]||{min:1e99,max:-1e99};for(a in I)for(c in M)M[c][a]?(M[c][a]>I[a].max&&(I[a].max=M[c][a]),M[c][a]<I[a].min&&(I[a].min=M[c][a])):(M[c][a]=0,I[a].min=0);return{midpoint:o=e.Solve(r,void 0,void 0,!0),vertices:M,ranges:I}}}),ts=H((e,r)=>{var o=$(),a=W(),h=L(),c=O(),v=U(),g=c.Constraint,y=c.Variable,m=c.Numeral,b=c.Term,x=ti(),Ot=function(){this.Model=a,this.branchAndCut=h,this.Constraint=g,this.Variable=y,this.Numeral=m,this.Term=b,this.Tableau=o,this.lastSolvedModel=null,this.External=x,this.Solve=function(e,r,o,h){if(h)for(var c in v)e=v[c](e);if(!e)throw Error("Solver requires a model to operate on");if("object"==typeof e.optimize&&Object.keys(e.optimize>1))return to()(this,e);if(e.external){var g=Object.keys(x);if(g=JSON.stringify(g),!e.external.solver)throw Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+g);if(!x[e.external.solver])throw Error("No support (yet) for "+e.external.solver+". Please use one of these instead:"+g);return x[e.external.solver].solve(e)}e instanceof a||(e=new a(r).loadJson(e));var y=e.solve();if(this.lastSolvedModel=e,y.solutionSet=y.generateSolutionSet(),o)return y;var m={};return m.feasible=y.feasible,m.result=y.evaluation,m.bounded=y.bounded,y._tableau.__isIntegral&&(m.isIntegral=!0),Object.keys(y.solutionSet).forEach(function(e){0!==y.solutionSet[e]&&(m[e]=y.solutionSet[e])}),m},this.ReformatLP=G(),this.MultiObjective=function(e){return to()(this,e)}};"function"==typeof define?define([],function(){return new Ot}):"object"==typeof window?window.solver=new Ot:"object"==typeof self&&(self.solver=new Ot),r.exports=new Ot}),ta=H((e,r)=>{var o,a,h=1e-60;do h+=h,o=1+.1*h,a=1+.2*h;while(o<=1||a<=1);r.exports=h}),tl=H((e,r)=>{r.exports=function(e,r,o){let a,h;for(let r=1;r<=o;r+=1){e[r][r]=1/e[r][r],h=-e[r][r];for(let o=1;o<r;o+=1)e[o][r]*=h;if(o<(a=r+1))break;for(let c=a;c<=o;c+=1){h=e[r][c],e[r][c]=0;for(let o=1;o<=r;o+=1)e[o][c]+=h*e[o][r]}}}}),th=H((e,r)=>{r.exports=function(e,r,o,a){let h,c;for(h=1;h<=o;h+=1){c=0;for(let r=1;r<h;r+=1)c+=e[r][h]*a[r];a[h]=(a[h]-c)/e[h][h]}for(let r=1;r<=o;r+=1){h=o+1-r,a[h]/=e[h][h],c=-a[h];for(let r=1;r<h;r+=1)a[r]+=c*e[r][h]}}}),tu=H((e,r)=>{r.exports=function(e,r,o,a){let h,c,v;for(let r=1;r<=o;r+=1){if(a[1]=r,v=0,(h=r-1)<1){if((v=e[r][r]-v)<=0)break;e[r][r]=Math.sqrt(v)}else{for(let o=1;o<=h;o+=1){c=e[o][r];for(let a=1;a<o;a+=1)c-=e[a][r]*e[a][o];c/=e[o][o],e[o][r]=c,v+=c*c}if((v=e[r][r]-v)<=0)break;e[r][r]=Math.sqrt(v)}a[1]=0}}}),td=H((e,r)=>{var o=ta(),a=tl(),h=th(),c=tu();r.exports=function(e,r,v,g,y,m,b,x,w,I,M,k,B,O=0,S,_,E){let j,z,N,$,L,W,U,G,Z,X,tt,ti,to,ts,ta=Math.min(g,M),tl=2*g+ta*(ta+5)/2+2*M+1;for(let e=1;e<=g;e+=1)_[e]=r[e];for(let e=g+1;e<=tl;e+=1)_[e]=0;for(let e=1;e<=M;e+=1)B[e]=0,m[e]=0;let th=[];if(0===E[1]){if(c(e,v,g,th),0!==th[1]){E[1]=2;return}h(e,v,g,r),a(e,v,g)}else{for(let o=1;o<=g;o+=1){y[o]=0;for(let a=1;a<=o;a+=1)y[o]+=e[a][o]*r[a]}for(let o=1;o<=g;o+=1){r[o]=0;for(let a=o;a<=g;a+=1)r[o]+=e[o][a]*y[a]}}b[1]=0;for(let o=1;o<=g;o+=1){y[o]=r[o],b[1]+=_[o]*y[o],_[o]=0;for(let r=o+1;r<=g;r+=1)e[r][o]=0}b[1]=-b[1]/2,E[1]=0;let tu=g+g,td=tu+ta,tf=td+ta+1,tc=tf+ta*(ta+1)/2,tp=tc+M;for(let e=1;e<=M;e+=1){W=0;for(let r=1;r<=g;r+=1)W+=x[r][e]*x[r][e];_[tp+e]=Math.sqrt(W)}function Pn(){return _[td+$]=_[td+$+1],_[td+$+1]=0,B[$]=0,$-=1,S[2]+=1,0}for($=O,S[1]=0,S[2]=0,ts=0;;){if(999===(ts=function(){S[1]+=1,tl=tc;for(let e=1;e<=M;e+=1){tl+=1,W=-w[e];for(let r=1;r<=g;r+=1)W+=x[r][e]*y[r];if(Math.abs(W)<o&&(W=0),e>k)_[tl]=W;else if(_[tl]=-Math.abs(W),W>0){for(let r=1;r<=g;r+=1)x[r][e]=-x[r][e];w[e]=-w[e]}}for(let e=1;e<=$;e+=1)_[tc+B[e]]=0;N=0,L=0;for(let e=1;e<=M;e+=1)_[tc+e]<L*_[tp+e]&&(N=e,L=_[tc+e]/_[tp+e]);if(0===N){for(let e=1;e<=$;e+=1)m[B[e]]=_[td+e];return 999}return 0}()))return;for(;0!==(ts=function(){for(let r=1;r<=g;r+=1){W=0;for(let o=1;o<=g;o+=1)W+=e[o][r]*x[o][N];_[r]=W}j=g;for(let e=1;e<=g;e+=1)_[j+e]=0;for(let r=$+1;r<=g;r+=1)for(let o=1;o<=g;o+=1)_[j+o]=_[j+o]+e[o][r]*_[r];ti=!0;for(let e=$;e>=1;e-=1){W=_[e],j=(tl=tf+e*(e+3)/2)-e;for(let r=e+1;r<=$;r+=1)W-=_[tl]*_[tu+r],tl+=r;W/=_[j],_[tu+e]=W,!(B[e]<=k)&&(W<=0||(ti=!1,z=e))}if(!ti){U=_[td+z]/_[tu+z];for(let e=1;e<=$;e+=1)B[e]<=k||_[tu+e]<=0||(L=_[td+e]/_[tu+e])<U&&(U=L,z=e)}W=0;for(let e=g+1;e<=g+g;e+=1)W+=_[e]*_[e];if(Math.abs(W)<=o){if(ti)return E[1]=1,999;for(let e=1;e<=$;e+=1)_[td+e]=_[td+e]-U*_[tu+e];return _[td+$+1]=_[td+$+1]+U,700}W=0;for(let e=1;e<=g;e+=1)W+=_[g+e]*x[e][N];G=-_[tc+N]/W,to=!0,ti||U<G&&(G=U,to=!1);for(let e=1;e<=g;e+=1)y[e]+=G*_[g+e],Math.abs(y[e])<o&&(y[e]=0);b[1]+=G*W*(G/2+_[td+$+1]);for(let e=1;e<=$;e+=1)_[td+e]=_[td+e]-G*_[tu+e];if(_[td+$+1]=_[td+$+1]+G,to){B[$+=1]=N,tl=tf+($-1)*$/2+1;for(let e=1;e<=$-1;e+=1)_[tl]=_[e],tl+=1;if($===g)_[tl]=_[g];else{for(let r=g;r>=$+1;r-=1)if(0!==_[r]&&(Z=Math.max(Math.abs(_[r-1]),Math.abs(_[r])),X=Math.min(Math.abs(_[r-1]),Math.abs(_[r])),L=_[r-1]>=0?Math.abs(Z*Math.sqrt(1+X*X/(Z*Z))):-Math.abs(Z*Math.sqrt(1+X*X/(Z*Z))),Z=_[r-1]/L,X=_[r]/L,1!==Z)){if(0===Z){_[r-1]=X*L;for(let o=1;o<=g;o+=1)L=e[o][r-1],e[o][r-1]=e[o][r],e[o][r]=L}else{_[r-1]=L,tt=X/(1+Z);for(let o=1;o<=g;o+=1)L=Z*e[o][r-1]+X*e[o][r],e[o][r]=tt*(e[o][r-1]+L)-e[o][r],e[o][r-1]=L}}_[tl]=_[$]}}else{W=-w[N];for(let e=1;e<=g;e+=1)W+=y[e]*x[e][N];if(N>k)_[tc+N]=W;else if(_[tc+N]=-Math.abs(W),W>0){for(let e=1;e<=g;e+=1)x[e][N]=-x[e][N];w[N]=-w[N]}return 700}return 0}());){if(999===ts)return;if(700===ts){if(z===$)Pn();else{for(;function(){if(0!==_[j=(tl=tf+z*(z+1)/2+1)+z]&&(Z=Math.max(Math.abs(_[j-1]),Math.abs(_[j])),X=Math.min(Math.abs(_[j-1]),Math.abs(_[j])),L=_[j-1]>=0?Math.abs(Z*Math.sqrt(1+X*X/(Z*Z))):-Math.abs(Z*Math.sqrt(1+X*X/(Z*Z))),Z=_[j-1]/L,X=_[j]/L,1!==Z)){if(0===Z){for(let e=z+1;e<=$;e+=1)L=_[j-1],_[j-1]=_[j],_[j]=L,j+=e;for(let r=1;r<=g;r+=1)L=e[r][z],e[r][z]=e[r][z+1],e[r][z+1]=L}else{tt=X/(1+Z);for(let e=z+1;e<=$;e+=1)L=Z*_[j-1]+X*_[j],_[j]=tt*(_[j-1]+L)-_[j],_[j-1]=L,j+=e;for(let r=1;r<=g;r+=1)L=Z*e[r][z]+X*e[r][z+1],e[r][z+1]=tt*(e[r][z]+L)-e[r][z+1],e[r][z]=L}}}(),797===(ts=function(){j=tl-z;for(let e=1;e<=z;e+=1)_[j]=_[tl],tl+=1,j+=1;return _[td+z]=_[td+z+1],B[z]=B[z+1],(z+=1)<$?797:0}()););Pn()}}}}}}),tf=H(e=>{var r=td();e.solveQP=function(e,o,a,h=[],c=0,v=[0,0]){let g=[],y=[],m=[],b=[],x=[],w=[],I="",M=e.length-1,k=a[1].length-1;if(!h)for(let e=1;e<=k;e+=1)h[e]=0;if(M!==e[1].length-1&&(I="Dmat is not symmetric!"),M!==o.length-1&&(I="Dmat and dvec are incompatible!"),M!==a.length-1&&(I="Amat and dvec are incompatible!"),k!==h.length-1&&(I="Amat and bvec are incompatible!"),(c>k||c<0)&&(I="Value of meq is invalid!"),""!==I)return{message:I};for(let e=1;e<=k;e+=1)y[e]=0,b[e]=0;let B=Math.min(M,k);for(let e=1;e<=M;e+=1)m[e]=0;g[1]=0;for(let e=1;e<=2*M+B*(B+5)/2+2*k+1;e+=1)x[e]=0;for(let e=1;e<=2;e+=1)w[e]=0;return r(e,o,M,M,m,b,g,a,h,M,k,c,y,0,w,x,v),1===v[1]&&(I="constraints are inconsistent, no solution!"),2===v[1]&&(I="matrix D in quadratic function is not positive definite!"),{solution:m,Lagrangian:b,value:g,unconstrained_solution:o,iterations:w,iact:y,message:I}}}),tc=H((e,r)=>{r.exports=tf()});function je(e){for(let r of e)return e.delete(r),r}function ut(e,r,o){let a=e.get(r);void 0===a?e.set(r,new Set([o])):a.add(o)}function Ut(e,r,o){let a=e.get(r);void 0!==a&&(a.delete(o),a.size||e.delete(r))}var{toString:tp}=Object.prototype,{propertyIsEnumerable:tv}=Object.prototype;function*Oe(e,...r){let o=new Set,a;for(;void 0!==(a=r.pop());)o.has(a)||(yield a,o.add(a),r.push(...e(a)))}function Ft(e,r){let o=[];for(let[a,h]of K(r))o.push(e[a]),o.push(h);return o.push(e[e.length-1]),o.join("")}function D(e,...r){return Error(Ft(e,A(r,e=>{let r;return r=[],function i(e,o={},a=""){var h,c,v;let g,y=o.indent||"	",m;m=void 0===o.inlineCharacterLimit?{newline:`
`,newlineOrSpace:`
`,pad:a,indent:a+y}:{newline:"@@__STRINGIFY_OBJECT_NEW_LINE__@@",newlineOrSpace:"@@__STRINGIFY_OBJECT_NEW_LINE_OR_SPACE__@@",pad:"@@__STRINGIFY_OBJECT_PAD__@@",indent:"@@__STRINGIFY_OBJECT_INDENT__@@"};let l=e=>{if(void 0===o.inlineCharacterLimit)return e;let r=e.replace(RegExp(m.newline,"g"),"").replace(RegExp(m.newlineOrSpace,"g")," ").replace(RegExp(m.pad+"|"+m.indent,"g"),"");return r.length<=o.inlineCharacterLimit?r:e.replace(RegExp(m.newline+"|"+m.newlineOrSpace,"g"),`
`).replace(RegExp(m.pad,"g"),a).replace(RegExp(m.indent,"g"),a+y)};if(r.includes(e))return'"[Circular]"';if(null==e||"number"==typeof e||"boolean"==typeof e||"function"==typeof e||"symbol"==typeof e||(h=e,"[object RegExp]"===tp.call(h)))return String(e);if(e instanceof Date)return`new Date('${e.toISOString()}')`;if(Array.isArray(e)){if(0===e.length)return"[]";r.push(e);let h="["+m.newline+e.map((r,h)=>{let c=e.length-1===h?m.newline:","+m.newlineOrSpace,v=i(r,o,a+y);return o.transform&&(v=o.transform(e,h,v)),m.indent+v+c}).join("")+m.pad+"]";return r.pop(),l(h)}if(g=typeof(c=e),null!==c&&("object"===g||"function"===g)){let h=[...Object.keys(v=e),...Object.getOwnPropertySymbols(v).filter(e=>tv.call(v,e))];if(o.filter&&(h=h.filter(r=>o.filter(e,r))),0===h.length)return"{}";r.push(e);let c="{"+m.newline+h.map((r,c)=>{let v=h.length-1===c?m.newline:","+m.newlineOrSpace,g="symbol"==typeof r,b=!g&&/^[a-z$_][$\w]*$/i.test(r),x=g||b?r:i(r,o),w=i(e[r],o,a+y);return o.transform&&(w=o.transform(e,r,w)),m.indent+String(x)+": "+w+v}).join("")+m.pad+"}";return r.pop(),l(c)}return e=String(e=e.replace(/\\/g,"\\\\")).replace(/[\r\n]/g,e=>e===`
`?"\\n":"\\r"),!1===o.singleQuotes?(e=e.replace(/"/g,'\\"'),`"${e}"`):(e=e.replace(/'/g,"\\'"),`'${e}'`)}(e,{indent:"  ",singleQuotes:!1,inlineCharacterLimit:60},void 0)})))}function jn(e){return`internal error: ${e}; if you encounter this please submit an issue at: https://github.com/erikbrinkman/d3-dag/issues`}function te(e,...r){return Error(jn(Ft(e,A(r,e=>e.toString()))))}function oe(e,r,...o){let[a,...h]=e,c=Ft(h,A(o,e=>e.toString())),v=r.name||"anonymous";return Error("d3dagBuiltin"in r?jn(`builtin ${a}'${v}'${c}`):`custom ${a}'${v}'${c}`)}function*K(e){let r=0;for(let o of e)yield[r++,o]}function*Ne(e,r){for(let[o,a]of K(e))yield*Y(r(a,o))}function*A(e,r){for(let[o,a]of K(e))yield r(a,o)}function*be(e,r){for(let[o,a]of K(e))r(a,o)&&(yield a)}function Zt(e,r){for(let[o,a]of K(e))if(r(a,o))return!0;return!1}function q(e,r=0,o=e.length,a=1){if(a>0)return function*(e,r,o,a){let h=Math.min(o,e.length);for(let o=r;o<h;o+=a)yield e[o]}(e,r,o,a);if(a<0)return function*(e,r,o,a){let h=Math.max(o,-1);for(let o=r;o>h;o+=a)yield e[o]}(e,r,o,a);throw D`can't slice with zero stride`}function*se(...e){for(let r of e)yield*Y(r)}function*Q(e){let r=e[Symbol.iterator](),o=r.next();if(!o.done){let e=o.value,a;for(;!(a=r.next()).done;)yield[e,a.value],e=a.value}}function Qt(e){let r=[],o,a=new Map;for(let[h,c]of K(e.nodes()))a.set(c,h),r.push({x:c.ux,y:c.uy,data:c.data}),c===e&&(o=h);let h=[];for(let{source:r,target:o,data:c,points:v}of e.links())h.push({source:a.get(r),target:a.get(o),points:v,data:c});return{nodes:r,links:h,index:o,v:1}}var tg=class{constructor(e,r,o,a="inactive"){this.node=e,this.indeg=r,this.outdeg=o,this.stat=a}bucket(){let e=0===this.indeg?-1/0:0===this.outdeg?1/0:this.indeg-this.outdeg;return"top"===this.stat?Math.min(e,0):"bottom"===this.stat?Math.max(e,0):e}isTop(){return this.indeg<=this.outdeg&&"bottom"!==this.stat||"top"===this.stat}};function Zn(e,r){let o=e[r];if(void 0!==o)return o;{let o=new Set;return e[r]=o,o}}function Jn(e){var r;let o;for(;e.length&&!(null!=(r=o=e[e.length-1])&&r.size);)e.pop();return o||void 0}function Yn(e,r=()=>{}){let o=new Map,a=new Map,h=new Set,c=new Set,v=[],g=[];function u(e){return e===-1/0?h:e===1/0?c:e<=0?Zn(v,-e):Zn(g,e-1)}for(let h of e){let e=h.nparentLinks(),c=h.nchildLinks(),v=new tg(h,e,c),g=r(h);o.set(h,v),void 0===g?(v.stat="active",u(v.bucket()).add(v)):ut(a,g,v)}let y=[...a].sort(([e],[r])=>e-r).map(([,e])=>e),m=0,b=y.length,x=y.length?y[m++]:new Set,w=y.length>1?y[--b]:new Set;for(let e of x)e.stat="top",u(e.bucket()).add(e);for(let e of w)e.stat="bottom",u(e.bucket()).add(e);let I=Array(o.size),M=0,k=o.size,B;for(;B=function(){var e;let r;if(r=null!=(e=je(h))?e:je(c))return r;let o=Jn(v),a=Jn(g);return a?je(v.length>g.length?o:a):o?je(o):void 0}();){let{node:e}=B,r=B.isTop()?M++:--k;for(let[a,h]of(B.stat="ranked",I[r]=e,e.parentCounts())){let e=o.get(a);u(e.bucket()).delete(e),e.outdeg-=h,"ranked"!==e.stat&&"inactive"!==e.stat&&u(e.bucket()).add(e)}for(let[r,a]of e.childCounts()){let e=o.get(r);u(e.bucket()).delete(e),e.indeg-=a,"ranked"!==e.stat&&"inactive"!==e.stat&&u(e.bucket()).add(e)}if(x.delete(B),!x.size&&m<b)for(let e of x=y[m++])e.stat="top",u(e.bucket()).add(e);if(w.delete(B),!w.size&&m<b)for(let e of w=y[--b])e.stat="bottom",u(e.bucket()).add(e)}return I}function Qn(e,r){let o=new Set,a=new Set,h=[],c;for(let v of e)if(!a.has(v)){for(h.push(v);c=h.pop();)o.delete(c),a.has(c)||(a.add(c),h.push(...r(c)));o.add(v)}return o}var ty,tm,tb,tx,tw,tI,tC,tM,tk,tB=class{constructor(){F(this,ty,0),F(this,tm,0),F(this,tb,0),F(this,tx,!0),F(this,tw,new Set),F(this,tI,new Set),F(this,tC,()=>{P(this,ty,C(this,ty)-1)}),F(this,tM,(e,r)=>{P(this,tm,C(this,tm)+1),e?P(this,tb,C(this,tb)+1):r||!0!==C(this,tx)||P(this,tx,null)}),F(this,tk,e=>{P(this,tm,C(this,tm)-1),e?P(this,tb,C(this,tb)-1):!1===C(this,tx)&&P(this,tx,null)})}*nodes(){for(let e of this.split())yield*Y(e.nodes())}topological(e){return Yn(this.nodes(),e)}*links(){for(let e of this.nodes())yield*Y(e.childLinks())}nnodes(){return C(this,ty)}nlinks(){return C(this,tm)}*roots(){for(let e of this.split())yield*Y(e.roots())}*leaves(){for(let e of this.split())yield*Y(e.leaves())}*split(){let e;for(yield*Y(C(this,tw));e=function(e){for(let r of e)return r}(C(this,tI));)yield e,e.nnodes()}connected(){let e=!1;for(let r of this.split()){if(e)return!1;e=!0}return!0}multi(){return!!C(this,tb)}acyclic(){if(null!==C(this,tx))return C(this,tx);for(let e of this.split())if(!e.acyclic())return P(this,tx,!1),!1;return P(this,tx,!0),!0}node(e){return P(this,ty,C(this,ty)+1),new tW(this,C(this,tw),C(this,tI),C(this,tC),C(this,tM),C(this,tk),e)}link(e,r,o){return e.link(e,r,o)}toJSON(){return Qt(this)}};function Kn(e){for(let r of e.values())for(let e of r)return e}function ze(e){return e instanceof tW}ty=new WeakMap,tm=new WeakMap,tb=new WeakMap,tx=new WeakMap,tw=new WeakMap,tI=new WeakMap,tC=new WeakMap,tM=new WeakMap,tk=new WeakMap;var tV,tO,tS,t_,tP,tR,tE,tj,tT,tz,tN,tD,tF,t$,tA,tL,tH,tJ,tW=class{constructor(e,r,o,a,h,c,v){this.data=v,F(this,t$),F(this,tL),F(this,tV,void 0),F(this,tO,void 0),F(this,tS,void 0),F(this,t_,void 0),F(this,tP,void 0),F(this,tR,void 0),F(this,tE,0),F(this,tj,0),F(this,tT,new Map),F(this,tz,0),F(this,tN,new Map),F(this,tD,void 0),F(this,tF,void 0),F(this,tJ,e=>{let{source:r,target:o}=e,a=r.nchildLinksTo(o)>1;if(a){P(r,tE,C(r,tE)-1);let e=ae(r,tL,tH).call(r);e.nlinks-=1,e.multis-=1}else{let e=ae(r,t$,tA).call(r);P(e,tF,null),C(this,tP).delete(e),C(this,tR).add(r),P(r,tD,r),P(r,tF,null),C(this,tR).add(o),P(o,tD,o),P(o,tF,null)}C(this,t_).call(this,a),Ut(C(r,tN),o,e),P(r,tz,C(r,tz)-1),Ut(C(o,tT),r,e),P(o,tj,C(o,tj)-1)}),P(this,tV,e),P(this,tP,r),P(this,tR,o),P(this,tO,a),P(this,tS,h),P(this,t_,c),P(this,tD,this),P(this,tF,{nnodes:1,nlinks:0,multis:0,acyclic:!0,roots:[this],leaves:[this]}),C(this,tP).add(this)}get x(){if(void 0===this.ux)throw D`can't get \`x\` when \`ux\` is undefined`;return this.ux}set x(e){this.ux=e}get y(){if(void 0===this.uy)throw D`can't get \`y\` when \`uy\` is undefined`;return this.uy}set y(e){this.uy=e}*nodes(){yield*Y(Oe(e=>se(e.children(),e.parents()),this))}topological(e){return Yn(this.nodes(),e)}*links(){for(let e of this.nodes())yield*Y(e.childLinks())}nnodes(){return ae(this,tL,tH).call(this).nnodes}nlinks(){return ae(this,tL,tH).call(this).nlinks}*split(){yield this}connected(){return!0}multi(){return ae(this,tL,tH).call(this).multis>0}acyclic(){let e=ae(this,tL,tH).call(this);return null===e.acyclic?e.acyclic=function(e){let r,o=new Map(A(e,e=>[e,e.nparents()])),a=[...A(be(o,([,e])=>0===e),([e])=>e)];for(let e of a)o.delete(e);for(;r=a.pop();)for(let e of r.children()){let r=o.get(e)-1;r?o.set(e,r):(o.delete(e),a.push(e))}return!o.size}(this.nodes()):e.acyclic}node(e){if(C(this,tV))return C(this,tV).node(e);throw D`can't add a node from a deleted node`}link(e,r,o){if(C(this,tV)){if(e===r)throw D`tried to create a link between the same node, but self loops are not supported`;if(ze(e)&&ze(r)&&C(e,tV)===C(r,tV)&&C(this,tV)===C(e,tV)){let a=new tU(C(this,tV),e,r,C(this,tJ),o),h=e.nchildLinksTo(r)>0,c=ae(e,t$,tA).call(e),v=C(c,tF),g=ae(r,t$,tA).call(r),y=C(g,tF);if(h&&v)P(e,tE,C(e,tE)+1),v.nlinks+=1,v.multis+=1;else if(h)P(e,tE,C(e,tE)+1);else if(c===g&&v)v.nlinks+=1,!0===v.acyclic&&(v.acyclic=null);else if(c!==g&&v&&y){let[e,r,o,a]=v.nnodes>y.nnodes?[c,v,g,y]:[g,y,c,v];C(this,tP).delete(o),P(o,tD,e),P(o,tF,void 0),r.nnodes+=a.nnodes,r.nlinks+=a.nlinks+1,r.multis+=a.multis,r.acyclic=!1!==r.acyclic&&!1!==a.acyclic&&(!0===r.acyclic&&!0===a.acyclic||null),r.roots=null,r.leaves=null}else c!==g&&(P(c,tF,null),P(g,tF,null));return C(this,tS).call(this,h,c!==g),P(e,tz,C(e,tz)+1),ut(C(e,tN),r,a),P(r,tj,C(r,tj)+1),ut(C(r,tT),e,a),a}throw D`when creating a link, both source and target must be current members of the same graph, and can't have been deleted`}throw D`can't add a link from a deleted node`}nparents(){return C(this,tT).size}nchildren(){return C(this,tN).size}nparentLinks(){return C(this,tj)}nchildLinks(){return C(this,tz)}nparentLinksTo(e){var r,o;return ze(e)&&null!=(o=null==(r=C(this,tT).get(e))?void 0:r.size)?o:0}*parentLinksTo(e){if(ze(e)){let r=C(this,tT).get(e);r&&(yield*Y(r))}}nchildLinksTo(e){var r,o;return ze(e)&&null!=(o=null==(r=C(this,tN).get(e))?void 0:r.size)?o:0}*childLinksTo(e){if(ze(e)){let r=C(this,tN).get(e);r&&(yield*Y(r))}}*parents(){yield*Y(C(this,tT).keys())}*children(){yield*Y(C(this,tN).keys())}*parentCounts(){for(let[e,r]of C(this,tT))yield[e,r.size]}*childCounts(){for(let[e,r]of C(this,tN))yield[e,r.size]}*parentLinks(){for(let e of C(this,tT).values())yield*Y(e)}*childLinks(){for(let e of C(this,tN).values())yield*Y(e)}*ancestors(){yield*Y(Oe(e=>e.parents(),this))}*descendants(){yield*Y(Oe(e=>e.children(),this))}*roots(){let e=ae(this,tL,tH).call(this);e.roots||(e.roots=[...Qn(this.nodes(),e=>e.children())]),yield*Y(e.roots)}*leaves(){let e=ae(this,tL,tH).call(this);e.leaves||(e.leaves=[...Qn(this.nodes(),e=>e.parents())]),yield*Y(e.leaves)}parent(e,r){return this.link(e,this,r)}child(e,r){return this.link(this,e,r)}delete(){if(C(this,tV)){let e;for(;e=Kn(C(this,tN));)e.delete();for(;e=Kn(C(this,tT));)e.delete();C(this,tP).delete(this),C(this,tR).delete(this),C(this,tO).call(this),P(this,tV,null),P(this,tF,null)}}toJSON(){return Qt(this)}};tV=new WeakMap,tO=new WeakMap,tS=new WeakMap,t_=new WeakMap,tP=new WeakMap,tR=new WeakMap,tE=new WeakMap,tj=new WeakMap,tT=new WeakMap,tz=new WeakMap,tN=new WeakMap,tD=new WeakMap,tF=new WeakMap,t$=new WeakSet,tA=function(){let e=this;for(;C(e,tD)!==e;)P(e,tD,C(C(e,tD),tD)),e=C(e,tD);return e},tL=new WeakSet,tH=function(){let e=ae(this,t$,tA).call(this);if(void 0===C(e,tF))throw te`undefined cached info`;if(null!==C(e,tF))return C(e,tF);{let e=0,r=0,o=0;for(let a of this.nodes())e+=1,r+=a.nchildLinks(),o+=C(a,tE),P(a,tD,this),P(a,tF,void 0),C(this,tR).delete(a);return C(this,tP).add(this),P(this,tF,{nnodes:e,nlinks:r,multis:o,acyclic:null,roots:null,leaves:null})}},tJ=new WeakMap;var tq,tY,tU=class{constructor(e,r,o,a,h){this.source=r,this.target=o,this.data=h,F(this,tq,void 0),F(this,tY,void 0),this.points=[],P(this,tq,e),P(this,tY,a)}delete(){C(this,tq)&&(C(this,tY).call(this,this),P(this,tq,null))}};function nr(e){function t(r,o){var a;return A(null!=(a=e(r,o))?a:[],e=>[e,void 0])}return t.wrapped=e,t}function ii(e){if("object"!=typeof e||null===e||!("id"in e))throw D`datum did not have an id field, and no id accessor was specified; try calling \`graphStratify().id(d => d...)\` to set a custom id accessor`;let{id:r}=e;if("string"==typeof r)return r;throw D`datum has an id field that was not a string, and no id accessor was specified; try calling \`graphStratify().id(d => d...)\` to set a custom id accessor`}function tr(e){var r;if("object"!=typeof e||null===e)throw D`default parentIds function expected datum to be an object but got: ${e}; try setting a custom accessor for parentIds with \`graphStratify().parentIds(d => ...)\``;if(!("parentIds"in e))return;let{parentIds:o}=e;if(void 0===o||"object"==typeof o&&null!==o&&Symbol.iterator in o&&"function"==typeof o[Symbol.iterator]&&(r=e=>"string"==typeof e,!Zt(o,(e,o)=>!r(e,o))))return o;throw D`default parentIds function expected parentIds to be an iterable of strings but got: ${o}; try setting a custom accessor for parentIds with \`graphStratify().parentIds(d => ...)\``}function ai(...e){if(e.length)throw D`got arguments to graphStratify(${e}), but constructor takes no arguments; these were probably meant as data which should be called as \`graphStratify()(...)\``;return function mt(e){function t(r){var o;let a=new tB,h=new Map,c=[];for(let[v,g]of r.entries()){let r=function(e){if("string"!=typeof e)throw D`id is supposed to be type string but got type ${typeof e}`;return e}(e.id(g,v)),y=a.node(g);for(let[r,a]of null!=(o=e.parentData(g,v))?o:[])c.push([r,y,a]);if(h.has(r))throw D`found a duplicate id: ${n}, but ids passed to \`graphStratify()\` must be unique`;h.set(r,y)}for(let[e,r,o]of c){let c=h.get(e);if(!c)throw D`missing id: ${e}; this id was references in a node's parentIds, but no node with that id exists`;a.link(c,r,o)}return a}function n(r){if(void 0===r)return e.id;{let{id:o}=e;return mt(R(T({},V(e,["id"])),{id:r}))}}return t.id=n,t.parentData=function(r){if(void 0===r)return e.parentData;{let{parentIds:o,parentData:a}=e;return mt(R(T({},V(e,["parentIds","parentData"])),{parentIds:function(e){function t(r,o){var a;return A(null!=(a=e(r,o))?a:[],([e])=>e)}return t.wrapped=e,t}(r),parentData:r}))}},t.parentIds=function(r){if(void 0===r)return e.parentIds;{let{parentIds:o,parentData:a}=e;return mt(R(T({},V(e,["parentIds","parentData"])),{parentIds:r,parentData:nr(r)}))}},t}({id:ii,parentIds:tr,parentData:nr(tr)})}function De(e,r){return null==e||null==r?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function tn(e,r){return(null==e||!(e>=e))-(null==r||!(r>=r))||(e<r?-1:e>r?1:0)}function gt(e,r){let o;if(void 0===r)for(let r of e)null!=r&&(o<r||void 0===o&&r>=r)&&(o=r);else{let a=-1;for(let h of e)null!=(h=r(h,++a,e))&&(o<h||void 0===o&&h>=h)&&(o=h)}return o}function yt(e,r){let o;if(void 0===r)for(let r of e)null!=r&&(o>r||void 0===o&&r>=r)&&(o=r);else{let a=-1;for(let h of e)null!=(h=r(h,++a,e))&&(o>h||void 0===o&&h>=h)&&(o=h)}return o}function et(e,r,o){let a=e[r];e[r]=e[o],e[o]=a}tq=new WeakMap,tY=new WeakMap;var tQ=An(ts());function fe(e,r,o,a,h={}){let c=tQ.Solve.call({},{optimize:e,opType:r,constraints:a,variables:o,ints:h}),{feasible:v}=c,g=V(c,["feasible"]);if(!v)throw te`could not find a feasible simplex solution`;return g}function uo(e){let r=[...e];if(r.sort((e,r)=>e-r),0!==r.length){if(2===r.length)return(r[0]+r[1])/2;if(r.length%2!=0)return r[(r.length-1)/2];{let e=r.length/2,o=r[0],a=r[e-1],h=r[e],c=r[r.length-1],v=a-o,g=c-h;return(a*g+h*v)/(v+g)}}}function ho([e,r,o]){if(e<=0||r<=0||o<=0)throw D`simplex weights must be positive, but got: ${e}, ${r}, ${o}`}function go(e,r){let o=new Map,a=new Map(e.map((e,r)=>[e,r]));return function(e,h){var c;let v=null==(c=o.get(e))?void 0:c.get(h);if(void 0!==v)return v;if(a.has(e)||a.has(h))return-1/0;{let c=0;for(let[o,v]of r(e)){let e=a.get(o);for(let[o,g]of r(h))c+=Math.sign(e-a.get(o))*v*g}let v=o.get(e);void 0===v?o.set(e,new Map([[h,c]])):v.set(h,c);let g=o.get(h);return void 0===g?o.set(h,new Map([[e,-c]])):g.set(e,-c),c}}}function Bt(e){let r=0;for(let[o,a]of Q(e)){let e=new Map(a.map((e,r)=>[e,r]));for(let[a,h]of o.entries())for(let c of o.slice(a+1))for(let[o,a]of h.childCounts())for(let[h,v]of c.childCounts())o!==h&&e.get(o)>e.get(h)&&(r+=a*v)}return r}function Vt(...e){if(e.length)throw D`got arguments to decrossDfs(${e}); you probably forgot to construct decrossDfs before passing to decross: \`sugiyama().decross(decrossDfs())\`, note the trailing "()"`;return function yo(e){function t(r){let o;for(let a of(o=e.topDown?Oe(e=>[...e.children()].sort((e,r)=>r.nchildren()-e.nchildren()),...Ne(r,e=>[...be(e,e=>!e.nparents())].sort((e,r)=>r.nchildren()-e.nchildren()))):Oe(e=>[...e.parents()].sort((e,r)=>r.nparents()-e.nparents()),...Ne(q(r,r.length-1,-1,-1),e=>[...be(e,e=>!e.nchildren())].sort((e,r)=>r.nparents()-e.nparents()))),r))a.splice(0);for(let e of o){let{data:o}=e;if("node"===o.role)for(let a=o.topLayer;a<=o.bottomLayer;++a)r[a].push(e);else r[o.layer].push(e)}}return t.topDown=function(r){return void 0===r?e.topDown:yo({topDown:r})},t.d3dagBuiltin=!0,t}({topDown:!0})}function In(e,r){return+!!(e&&r)}function No(){}function ji(...e){if(e.length)throw D`got arguments to sugiyama(${e}), but constructor takes no arguments; these were probably meant as data which should be called as \`sugiyama()(...)\``;return function Me(e,r){function n(o){let a;if(o.nnodes()){var h;let[c,v]=function(e){if("function"==typeof e)return[r=>e(r)[0],r=>e(r)[1]];{let[r,o]=e;return[()=>r,()=>o]}}(function(e){if("function"!=typeof e){let[r,o]=e;if(r<=0||o<=0)throw D`all node sizes must be positive, but got width ${r} and height ${o}`;return()=>[r,o]}{let r=new Map;return o=>{let a=r.get(o);if(void 0===a){let[h,c]=a=e(o);if(h<=0||c<=0)throw D`all node sizes must be positive, but got width ${h} and height ${c} for node with data: ${o.data}; make sure the callback passed to \`sugiyama().nodeSize(...)\` is doing that`;r.set(o,a)}return a}}}(e.nodeSize)),[g,y]=r.gap,m=e.layering(o,In)+1,[b,x]=function(e,r,o,a,h){let c=new tB,v=Array(a).fill(!1),g=new Map;for(let r of e.nodes()){let e=r.uy;if(void 0===e)throw oe`layering ${h} didn't assign a layer to a node`;if(e<0||e>=a)throw oe`layering ${h} assigned node an invalid layer: ${e}`;{let o=se(r.parentCounts(),r.childCounts());!v[e]&&Zt(o,([{uy:r},o])=>o>1&&r===e-1)&&(v[e]=!0);let a={node:r,topLayer:e,bottomLayer:e,role:"node"};g.set(r,[a,c.node(a)])}}let y=0,m=v.map(e=>y+=+e);for(let[e]of g.values()){let r=m[e.topLayer];e.topLayer+=r,e.bottomLayer+=r}let b=function(e,r,o,a){for(let[o,[h,c]]of r){let v=h.bottomLayer;for(let h of o.childLinks()){let[o,g]=r.get(h.target),y=o.topLayer;if(y>v){let r=c;for(let o=v+1;o<y;++o){let a=e.node({link:h,layer:o,role:"link"});r.child(a,void 0),r=a}r.child(g)}else if(y<v){let r=g;for(let o=y+1;o<v;++o){let a=e.node({link:h,layer:o,role:"link"});r.child(a,void 0),r=a}r.child(c)}else throw oe`layering ${a} assigned nodes with an edge to the same layer`}}let h=Array(o).fill(null).map(()=>[]);for(let r of e.nodes()){let{data:e}=r;if("node"===e.role){let{topLayer:o,bottomLayer:a}=e;for(let e=o;e<=a;++e)h[e].push(r)}else{let{layer:o}=e;h[o].push(r)}}for(let e of h)if(!e.length)throw oe`layering ${a} didn't assign a node to every layer`;return h}(c,g,a+y,h),x=-o;for(let e of b){x+=o;let a=Math.max(-o,...A(e,({data:e})=>"node"===e.role?r(e.node):-1/0)),h=x+a/2;for(let r of e)r.y=h;x+=a}return[b,x]}(o,v,y,m,e.layering);e.decross(b);let w=(h=function(e,r=0){return({data:o})=>"node"===o.role?e(o.node):r}(c),function(e,r){let o=((e?h(e):0)+(r?h(r):0))/2;return e&&r?o+g:o}),I=e.coord(b,w);(function(e,r,o,a,h=.001){for(let c of e){for(let e of c)if(void 0===e.ux)throw oe`coord ${a} didn't assign an x to every node`;for(let[[e,v],[g,y]]of Q(se([[void 0,0]],A(c,e=>[e,e.x]),[[void 0,o]])))if(y-v<r(e,g)-h)throw oe`coord ${a} assigned nodes too close for separation`}})(b,w,I,e.coord),function(e){for(let r of e)for(let e of r)if("node"===e.data.role){let{node:r}=e.data;for(let o of(r.x=e.x,r.y=e.y,e.children())){let a=[[e.x,e.y]],h;for(;"link"===o.data.role;)h=o.data.link,a.push([o.x,o.y]),[o]=o.children();a.push([o.x,o.y]);let c=o.data.node,v=se(r.childLinksTo(c),r.parentLinksTo(c));h||([h]=v),h.source!==r&&a.reverse(),h.points.splice(0,h.points.length,...a)}}}(b),a={width:I,height:x}}else a={width:0,height:0};for(let r of e.tweaks)a=r(o,a);return a}return n.layering=function(o){if(void 0===o)return e.layering;{let{layering:a}=e;return Me(R(T({},V(e,["layering"])),{layering:o}),r)}},n.decross=function(o){if(void 0===o)return e.decross;{let{decross:a}=e;return Me(R(T({},V(e,["decross"])),{decross:o}),r)}},n.coord=function(o){if(void 0===o)return e.coord;{let{coord:a}=e;return Me(R(T({},V(e,["coord"])),{coord:o}),r)}},n.tweaks=function(o){if(void 0===o)return e.tweaks;{let{tweaks:a}=e;return Me(R(T({},V(e,["tweaks"])),{tweaks:o}),r)}},n.nodeSize=function(o){if(void 0===o)return e.nodeSize;if("function"!=typeof o&&(o[0]<=0||o[1]<=0)){let[e,r]=o;throw D`constant nodeSize must be positive, but got: [${e}, ${r}]`}{let{nodeSize:a}=e;return Me(R(T({},V(e,["nodeSize"])),{nodeSize:o}),r)}},n.gap=function(o){if(void 0!==o){let[a,h]=o;if(a<0||h<0)throw D`gap width (${a}) and height (${h}) must be non-negative`;return Me(e,R(T({},r),{gap:o}))}{let[e,o]=r.gap;return[e,o]}},n}({layering:function(...e){if(e.length)throw D`got arguments to layeringSimplex(${e}); you probably forgot to construct layeringSimplex before passing to layering: \`sugiyama().layering(layeringSimplex())\`, note the trailing "()"`;return function Cn(e){function t(r,o){var a;let h={},c={},v=new Map(A(r.nodes(),(e,r)=>[e,r.toString()]));function d(e){return v.get(e)}function f(e,r,o,a,v=0){let g=h[d(r)],y=h[d(o)],m=`${e}: ${d(r)} -> ${d(o)}`;c[m]={min:a},g[m]=-1,y[m]=1,g.opt+=v,y.opt-=v}function p(e,r,o){f(`${e} before`,r,o,0),f(`${e} after`,o,r,0)}let g=[],y=new Map;for(let o of r.nodes()){h[d(o)]={opt:0};let r=e.rank(o);void 0!==r&&g.push([r,o]);let a=e.group(o);if(void 0!==a){let e=y.get(a);e?e.push(o):y.set(a,[o])}}let m=new Set;for(let a of r.topological(e.rank)){for(let[e,r]of a.childCounts())m.has(e)?f("link",e,a,o(e,a),r):f("link",a,e,o(a,e),r);m.add(a)}for(let[[e,r],[a,h]]of Q(g.sort(([e],[r])=>e-r)))e<a?f("rank",r,h,o(r,h)):p("rank",r,h);for(let e of y.values())for(let[r,o]of Q(e))p("group",r,o);try{let e=fe("opt","max",h,c,{}),v=0,g=0;for(let h of r.nodes()){let r=null!=(a=e[d(h)])?a:0;h.y=r,v=Math.min(v,r-o(void 0,h)),g=Math.max(g,r+o(h,void 0))}for(let e of r.nodes())e.y-=v;return g-v}catch(e){throw y.size?D`could not find a feasible simplex layout; this is likely due to group constraints producing an infeasible layout, try relaxing the functions you're passing to \`layeringSimplex().group(...)\``:te`could not find a feasible simplex solution`}}return t.rank=function(r){if(void 0===r)return e.rank;{let{rank:o}=e;return Cn(R(T({},V(e,["rank"])),{rank:r}))}},t.group=function(r){if(void 0===r)return e.group;{let{group:o}=e;return Cn(R(T({},V(e,["group"])),{group:r}))}},t.d3dagBuiltin=!0,t}({rank:No,group:No})}(),decross:function(...e){if(e.length)throw D`got arguments to decrossTwoLayer(${e}); you probably forgot to construct decrossTwoLayer before passing to decross: \`sugiyama().decross(decrossTwoLayer())\`, note the trailing "()"`;return function $t(e){function t(r){let o=r.slice().reverse(),a=r.map(e=>e.slice()),h=Bt(a);for(let c of e.inits.length?e.inits:[()=>{}]){c(r);let v=!0;for(let c=0;c<e.passes&&v;++c){for(let[o,a]of(v=!1,Q(r))){let r=a.slice();e.order(o,a,!0),a.some((e,o)=>r[o]!==e)&&(v=!0)}let c=Bt(r);for(let[g,y]of(c<h&&(h=c,a=r.map(e=>e.slice())),Q(o))){let r=y.slice();e.order(y,g,!1),y.some((e,o)=>r[o]!==e)&&(v=!0)}let g=Bt(r);g<h&&(h=g,a=r.map(e=>e.slice()))}}r.splice(0,r.length,...a)}return t.order=function(r){if(void 0===r)return e.order;{let{order:o}=e;return $t(R(T({},V(e,["order"])),{order:r}))}},t.inits=function(r){if(void 0===r)return[...e.inits];{let{inits:o}=e;return $t(R(T({},V(e,["inits"])),{inits:r}))}},t.passes=function(r){if(void 0===r)return e.passes;if(r<=0)throw D`number of passes must be positive`;return $t(R(T({},e),{passes:r}))},t.d3dagBuiltin=!0,t}({order:(function(...e){if(e.length)throw D`got arguments to twolayerGreedy(${e}); you probably forgot to construct twolayerGreedy before passing to order: \`decrossTwoLayer().order(twolayerGreedy())\`, note the trailing "()"`;return function wn({baseOp:e,doScan:r}){function n(o,a,h){e(o,a,h);let c=h?a:o,v=h?go(o,e=>e.parentCounts()):go(a,e=>e.childCounts());r?function(e,r){let o=Array(e.length*(e.length-1)/2);for(;;){let a=0;for(let h=1;h<e.length;++h){let c=0,v=a;for(let a=h-1;a>=0;--a)o[v]=c,c+=r(e[a],e[h]),v-=e.length-a-1;a+=e.length-h}let h=0,c=0,v=0,g=0;for(let a=0;a<e.length-1;++a){let y=0;for(let m=a+1;m<e.length;++m){y+=r(e[a],e[m]);let b=o[h++]+y;b>c&&(c=b,v=a,g=m)}}if(0===c)break;let y=e[g];e[g]=e[v],e[v]=y}}(c,v):function(e,r){let o=[[0,e.length]],a;for(;a=o.pop();){let[h,c]=a;if(h>=c)continue;let v=0,g=c;for(let o=h;o<c-1;++o){let a=r(e[o],e[o+1]);a>v&&(v=a,g=o)}if(g!==c){let r=e[g+1];e[g+1]=e[g],e[g]=r,o.push([h,g],[g+2,c])}}}(c,v)}return n.base=function(o){return void 0===o?e:wn({baseOp:o,doScan:r})},n.scan=function(o){return void 0===o?r:wn({baseOp:e,doScan:o})},n.d3dagBuiltin=!0,n}({baseOp:()=>{},doScan:!1})})().base(function(...e){if(e.length)throw D`got arguments to twolayerAgg(${e}); you probably forgot to construct twolayerAgg before passing to order: \`decrossTwoLayer().order(twolayerAgg())\`, note the trailing "()"`;return function lo({aggregate:e}){function t(r,o,a){let[h,c]=a?[o,r]:[r,o],v=a?e=>e.parents():e=>e.children(),g=new Map(c.map((e,r)=>[e,r])),y=new Map(h.map(r=>{let o=g.get(r),a=null!=o?o:e(A(v(r),e=>g.get(e)));return[r,a]}));!function(e,r){let o=new Map;for(let a of e){let e=r.get(a);void 0!==e&&function(e,r,o){let a=e.get(r);void 0===a?e.set(r,[o]):a.push(o)}(o,e,a)}let a=[...o.entries()].sort(([e],[r])=>e-r).flatMap(([,e])=>e),h=new Map(e.map((e,r)=>[e,r])),c=e.filter(e=>void 0===r.get(e)),v=Array(c.length).fill(null);(function s(e,r,o,g){if(r<=e)return;let y=Math.floor((e+r)/2),m=c[y],b=h.get(m),x=0,w=[0];for(let e=o;e<g;++e)x+=h.get(a[e])<b?-1:1,w.push(x);let I=o+w.indexOf(Math.min(...w));v[y]=I,s(e,y,o,I),s(y+1,r,I,g)})(0,c.length,0,a.length),v.push(a.length+1);let g=0,y=0;for(let[r,o]of a.entries()){for(;v[y]==r;)e[g++]=c[y++];e[g++]=o}for(;v[y]==a.length;)e[g++]=c[y++]}(h,y)}return t.aggregator=function(r){return void 0===r?e:lo({aggregate:r})},t.d3dagBuiltin=!0,t}({aggregate:uo})}()),inits:[Vt().topDown(!0),Vt().topDown(!1)],passes:24})}(),coord:function(...e){if(e.length)throw D`got arguments to coordSimplex(${e}); you probably forgot to construct coordSimplex before passing to coord: \`sugiyama().coord(coordSimplex())\`, note the trailing "()"`;return function mo(e){function t(r,o){var a;let h={},c={},v=function(e,r){if("function"!=typeof r){let[e,o,a]=r;return(r,h)=>{switch(+("node"===r.data.role)+ +("node"===h.data.role)){case 0:return a;case 1:return o;case 2:return e;default:throw te`invalid count`}}}{let o=new Map;for(let a of Ne(e,e=>e))if("node"===a.data.role){let e=a.data.node,h=new Map;for(let o of e.childLinks()){let{target:e}=o,a=r(o);ho(a),h.set(e,a)}o.set(e,h)}return(e,r)=>{if("link"===e.data.role){let{source:a,target:h}=e.data.link,[,c,v]=o.get(a).get(h);return"link"===r.data.role?v:c}if("link"===r.data.role){let{source:e,target:a}=r.data.link,[,h]=o.get(e).get(a);return h}{let[a]=o.get(e.data.node).get(r.data.node);return a}}}}(r,e.weight),g=new Map,y=0;for(let e of r)for(let r of e)if(!g.has(r)){let e=`${y++}`;g.set(r,e),h[e]={}}function l(e){return g.get(e)}for(let e of r)for(let[r,a]of Q(e)){let e=l(r),v=l(a),g=`layer ${e} -> ${v}`,y=o(r,a);c[g]={min:y},h[e][g]=-1,h[v][g]=1}let m=function(e){let r=0,o=0;for(let a of e)o++,r+=(a-r)/o;return o?r:void 0}(Ne(g.keys(),e=>A(e.children(),r=>r.y-e.y)));for(let e of g.keys()){let r=l(e);for(let o of e.children()){let a=l(o),g=`link ${r} -> ${a}`,y=`${g} parent`;c[y]={min:0};let b=`${g} child`;c[b]={min:0},h[r][y]=1,h[r][b]=-1,h[a][y]=-1,h[a][b]=1;let x=v(e,o),w=(o.y-e.y)/m;h[g]={opt:x/w,[y]:1,[b]:1}}}let b=fe("opt","min",h,c);for(let[e,r]of g)e.x=null!=(a=b[r])?a:0;let x=0,w=0;for(let e of r){let r=e[0];x=Math.min(x,r.x-o(void 0,r));let a=e[e.length-1];w=Math.max(w,a.x+o(a,void 0))}for(let e of g.keys())e.x-=x;let I=w-x;if(I<=0)throw D`must assign nonzero width to at least one node; double check the callback passed to \`sugiyama().nodeSize(...)\``;return I}return t.weight=function(r){if(void 0===r)return e.weight;{"function"!=typeof r&&ho(r);let{weight:o}=e;return mo(R(T({},V(e,["weight"])),{weight:r}))}},t.d3dagBuiltin=!0,t}({weight:[1,2,8]})}(),nodeSize:[1,1],tweaks:[]},{gap:[1,1]})}function ko(e,r){for(let o of e){let e=function(e,r,o){if(!(!(a=(e=Float64Array.from(function*(e,r){if(void 0===r)for(let r of e)null!=r&&(r=+r)>=r&&(yield r);else{let o=-1;for(let a of e)null!=(a=r(a,++o,e))&&(a=+a)>=a&&(yield a)}}(e,o))).length)||isNaN(r=+r))){if(r<=0||a<2)return yt(e);if(r>=1)return gt(e);var a,h=(a-1)*r,c=Math.floor(h),v=gt((function Nt(e,r,o=0,a=1/0,h){if(r=Math.floor(r),o=Math.floor(Math.max(0,o)),a=Math.floor(Math.min(e.length-1,a)),!(o<=r&&r<=a))return e;for(h=void 0===h?tn:function(e=De){if(e===De)return tn;if("function"!=typeof e)throw TypeError("compare is not a function");return(r,o)=>{let a=e(r,o);return a||0===a?a:(0===e(o,o))-(0===e(r,r))}}(h);a>o;){if(a-o>600){let c=a-o+1,v=r-o+1,g=Math.log(c),y=.5*Math.exp(2*g/3),m=.5*Math.sqrt(g*y*(c-y)/c)*(v-c/2<0?-1:1),b=Math.max(o,Math.floor(r-v*y/c+m)),x=Math.min(a,Math.floor(r+(c-v)*y/c+m));Nt(e,r,b,x,h)}let c=e[r],v=o,g=a;for(et(e,o,r),h(e[a],c)>0&&et(e,o,a);v<g;){for(et(e,v,g),++v,--g;0>h(e[v],c);)++v;for(;h(e[g],c)>0;)--g}0===h(e[o],c)?et(e,o,g):et(e,++g,a),g<=r&&(o=g+1),r<=g&&(a=g-1)}return e})(e,c).subarray(0,c+1));return v+(yt(e.subarray(c+1))-v)*(h-c)}}([...A(r(o),({x:e})=>e)],.5,void 0);void 0!==e&&(o.x=e)}}function vo(e,r){for(let o of e){let[e]=r(o);"link"===o.data.role&&"link"===e.data.role&&(o.x=e.x)}}function it(e,r){let o=e[e.length-1],a=o.x,h=[a];for(let c of q(e,e.length-2,-1,-1)){let e=Math.min(c.x,a-r(o,c));h.push(e),o=c,a=e}for(let[c,v]of(h.reverse(),a=(o=e[0]).x,o.x=(a+h[0])/2,K(q(e,1)))){let e=Math.max(v.x,a+r(o,v));v.x=(e+h[c+1])/2,o=v,a=e}}function Fi(...e){if(e.length)throw D`got arguments to coordGreedy(${e}); you probably forgot to construct coordGreedy before passing to coord: \`sugiyama().coord(coordGreedy())\`, note the trailing "()"`;function t(e,r){let o=0,a=0,h=new Set;for(let r of e)for(let e of r)h.has(e)||(h.add(e),void 0!==e.ux&&(o+=(e.ux-o)/++a));for(let a of e){let e=0,h=0;for(let r of a)void 0!==r.ux&&(e+=(r.ux-e)/++h);let c=h?e:o;for(let e of a)void 0===e.ux&&(e.ux=c);it(a,r)}for(let o of q(e,1))ko(o,e=>e.parents()),it(o,r);for(let o of q(e,e.length-2,-1,-1))ko(o,e=>e.children()),it(o,r);for(let o=0;o<e.length;++o){let o=e.map(e=>e.map(({x:e})=>e));for(let o of q(e,1))vo(o,e=>e.parents()),it(o,r);for(let o of q(e,e.length-2,-1,-1))vo(o,e=>e.children()),it(o,r);if(function(e,r){for(let[o,a]of e.entries()){let e=r[o];for(let[r,{x:o}]of a.entries())if(e[r]!==o)return!1}return!0}(e,o))break}let c=1/0,v=-1/0;for(let o of e){let e=o[0];c=Math.min(c,e.x-r(void 0,e));let a=o[o.length-1];v=Math.max(v,a.x+r(a,void 0))}for(let e of h)e.x-=c;let g=v-c;if(g<=0)throw D`must assign nonzero width to at least one node; double check the callback passed to \`sugiyama().nodeSize(...)\``;return g}return t.d3dagBuiltin=!0,t}An(tc())}}]);